import{r as N,j as e,c as as,R as os}from"./vendor-react-QK7G4MDf.js";import{o as Te,s as we,c as ee,a as ve,r as ls}from"./vendor-zod-Rs9PvQDD.js";import{V as gi}from"./vendor-CElDmkQT.js";import{u as cs,i as us,a as ds,b as gs,c as hs,d as ms,e as ps,f as fs,g as bs,h as vs,j as ys,k as ks,l as Ss}from"./vendor-echarts-Cbwmcc-H.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}})();const xs={datasets:{NNGYK:{name:"NNGYK (Hungary)",description:"Aggregated national respiratory surveillance (ILI focus)."}},years:[2025],viruses:["ILI (flu-like illness)"],weekly:[{dataset:"NNGYK",year:2025,virus:"ILI (flu-like illness)",week:40,cases:2100,region:"National"},{dataset:"NNGYK",year:2025,virus:"ILI (flu-like illness)",week:42,cases:2480,region:"National"},{dataset:"NNGYK",year:2025,virus:"ILI (flu-like illness)",week:44,cases:3120,region:"National"},{dataset:"NNGYK",year:2025,virus:"ILI (flu-like illness)",week:46,cases:3890,region:"National"},{dataset:"NNGYK",year:2025,virus:"ILI (flu-like illness)",week:48,cases:4510,region:"National"}],sariWeekly:[{year:2025,week:40,admissions:94,icu:10},{year:2025,week:42,admissions:120,icu:14},{year:2025,week:44,admissions:180,icu:22},{year:2025,week:46,admissions:220,icu:28}],virologyDetections:[{year:2025,week:40,virus:"SARS-CoV-2",detections:20},{year:2025,week:46,virus:"Influenza A(H1N1pdm09)",detections:2},{year:2025,week:46,virus:"RSV",detections:1}],virologyPositivity:[{year:2025,week:40,virus:"SARS-CoV-2",positivity:19.4},{year:2025,week:46,virus:"Influenza",positivity:1.5},{year:2025,week:46,virus:"RSV",positivity:.7}],variants:[]},Ns={2024:"2024-2025",2025:"2025-2026"},ws=Te({dataset:we().optional(),year:ee.number(),virus:we().optional(),week:ee.number(),cases:ee.number().nullable().optional(),region:we().optional()}).passthrough(),Ls=Te({year:ee.number(),week:ee.number(),admissions:ee.number().nullable().optional(),icu:ee.number().nullable().optional()}).passthrough(),Hi=Te({year:ee.number().optional(),week:ee.number(),virus:we().optional(),detections:ee.number().nullable().optional()}).passthrough(),Ui=Te({year:ee.number().optional(),week:ee.number(),virus:we().optional(),positivity:ee.number().nullable().optional()}).passthrough(),yi=Te({years:ve(ee.number()).default([]),weekly:ve(ws).default([]),sariWeekly:ve(Ls).default([]),virologyDetections:ve(Hi).default([]),virologyPositivity:ve(Ui).default([]),ervissDetections:ve(Hi).default([]),ervissPositivity:ve(Ui).default([])}).passthrough(),js=ls(we()).default({}),Yi="NNGYK",ft="ILI (flu-like illness)",ke="__all_viruses__",ie="__influenza_all__",De=28900,Ce=40,bt=20,Is=yi.parse(xs),zs=js.parse(Ns);function He(i){return{source:"bundled",respiratoryData:Is,seasonLabels:zs,iliAgeSplits:[],note:i}}function _i(i){return i>=Ce?i:i+53}function de(i,t){return _i(i)-_i(t)}function vt(i){return i>=Ce||i<=bt}function yt(i,t,n){return vt(t)?i===n&&t>=Ce||i===n+1&&t<=bt:!1}function Oi(i,t){return!Number.isFinite(i)||!Number.isFinite(t)||!vt(t)?null:t>=Ce?i:i-1}function As(i){const t=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const s=t.getUTCFullYear(),l=new Date(Date.UTC(s,0,1)),a=Math.ceil(((t.getTime()-l.getTime())/864e5+1)/7);return{year:s,week:a}}function Ts(i=new Date){const{year:t,week:n}=As(i);return n>=Ce?t:t-1}function me(i){return`W${String(i).padStart(2,"0")}`}function hi(i,t){const n=i[String(t)];return n||`${t}-${t+1}`}function $e(i){if(!i)return"";const t=String(i).normalize("NFKC").replace(/\u00a0/g," ").replace(/\s+/g," ").trim();return t?/^ili\s*\(\s*flu[-\s]*like illness\s*\)$/i.test(t)?ft:/^influenza$/i.test(t)?"Influenza":/^influenza\s+a$/i.test(t)?"Influenza A":/^influenza\s+b$/i.test(t)?"Influenza B":/^influenza\s+untyped$/i.test(t)?"Influenza (untyped)":/^influenza\s+a\s*\(\s*h1n1pdm09\s*\)$/i.test(t)||/^influenza\s+a\s*\(\s*h1pdm09\s*\)$/i.test(t)||/^influenza\s+a\s+h1n1pdm09$/i.test(t)||/^influenza\s+a\s+h1pdm09$/i.test(t)?"Influenza A(H1N1pdm09)":/^influenza\s+a\s*\(\s*h3\s*\)$/i.test(t)||/^influenza\s+a\s+h3$/i.test(t)?"Influenza A(H3)":/^influenza\s+a\s*\(\s*nt\s*\)$/i.test(t)||/^influenza\s+a\s+nt$/i.test(t)?"Influenza A(NT)":/^a\s*\(\s*h1\s*\)\s*pdm09$/i.test(t)?"Influenza A(H1N1pdm09)":/^a\s*\(\s*h3\s*\)$/i.test(t)?"Influenza A(H3)":/^a\s*\(\s*unknown\s*\)$/i.test(t)?"Influenza A(NT)":/^sars[-\s]*cov[-\s]*2$/i.test(t)?"SARS-CoV-2":/^rs[-\s]*v(i[íi]rus)?$/i.test(t)?"RSV":t:""}function Cs(i){return i===ie?!1:$e(i).startsWith("Influenza")}function $s(i,t){const n=new Map;for(const l of i.virologyDetections){const a=Number(l.year);if(Number.isFinite(a)&&a!==t)continue;const d=Number(l.week);if(!Number.isFinite(d))continue;const u=Number(l.detections??0);if(!Number.isFinite(u))continue;const h=$e(l.virus);if(!h)continue;const g=`${d}::${h}`,b=n.get(g);if(b){b.detections+=u;continue}n.set(g,{week:d,label:me(d),virus:h,detections:u})}const s=new Map;for(const l of n.values())Cs(l.virus)&&s.set(l.week,(s.get(l.week)??0)+l.detections);for(const[l,a]of s.entries())!Number.isFinite(a)||a<=0||n.set(`${l}::${ie}`,{week:l,label:me(l),virus:ie,detections:a});return Array.from(n.values()).sort((l,a)=>de(l.week,a.week)||l.virus.localeCompare(a.virus))}function Es(i,t){const n=new Map;for(const s of i.virologyPositivity){const l=Number(s.year);if(Number.isFinite(l)&&l!==t)continue;const a=Number(s.week);if(!Number.isFinite(a))continue;const d=Number(s.positivity??0);if(!Number.isFinite(d))continue;const u=$e(s.virus);if(!u)continue;const h=`${a}::${u}`,g=n.get(h);(!g||d>g.positivity)&&n.set(h,{week:a,label:me(a),virus:u,positivity:d})}return Array.from(n.values()).sort((s,l)=>de(s.week,l.week)||s.virus.localeCompare(l.virus))}function Ws(i,t){const n=$s(i,t),s=Es(i,t),l=Array.from(new Set(n.map(u=>u.virus))).sort((u,h)=>u===ie?-1:h===ie?1:u.localeCompare(h)),a=Array.from(new Set(n.map(u=>u.week).concat(s.map(u=>u.week)).filter(u=>Number.isFinite(u)))),d=a.length?a.reduce((u,h)=>de(h,u)>0?h:u,a[0]):null;return{available:n.length>0||s.length>0,latestWeek:d,availableDetectionViruses:l,detectionRows:n,positivityRows:s}}function Fs(i,t){const n=new Map;for(const s of i.ervissDetections){const l=Number(s.year);if(!Number.isFinite(l))continue;const a=Number(s.week);if(!Number.isFinite(a)||!yt(l,a,t))continue;const d=Number(s.detections??0);if(!Number.isFinite(d))continue;const u=$e(s.virus);if(!u)continue;const h=`${a}::${u}`,g=n.get(h);if(g){g.detections+=d;continue}n.set(h,{week:a,label:me(a),virus:u,detections:d})}return Array.from(n.values()).sort((s,l)=>de(s.week,l.week)||s.virus.localeCompare(l.virus))}function Rs(i,t){const n=new Map;for(const s of i.ervissPositivity){const l=Number(s.year);if(!Number.isFinite(l))continue;const a=Number(s.week);if(!Number.isFinite(a)||!yt(l,a,t))continue;const d=Number(s.positivity??0);if(!Number.isFinite(d))continue;const u=$e(s.virus);if(!u)continue;const h=`${a}::${u}`,g=n.get(h);(!g||d>g.positivity)&&n.set(h,{week:a,label:me(a),virus:u,positivity:d})}return Array.from(n.values()).sort((s,l)=>de(s.week,l.week)||s.virus.localeCompare(l.virus))}function Ds(i){const t=Array.from(new Set(i.ervissDetections.map(u=>Oi(Number(u.year),Number(u.week))).concat(i.ervissPositivity.map(u=>Oi(Number(u.year),Number(u.week)))).filter(u=>typeof u=="number"&&Number.isFinite(u)))).sort((u,h)=>u-h);if(!t.length)return{available:!1,availableYears:[],targetYear:null,latestWeek:null,detectionRows:[],positivityRows:[]};const n=Ts(),s=t.includes(n)?n:t[t.length-1],l=Fs(i,s),a=Rs(i,s),d=(()=>{const u=l.map(h=>h.week).concat(a.map(h=>h.week));return u.length?u.reduce((h,g)=>de(g,h)>0?g:h,u[0]):null})();return{available:l.length>0||a.length>0,availableYears:t,targetYear:s,latestWeek:d,detectionRows:l,positivityRows:a}}function mi(i,t){const n=new Map;for(const s of i.weekly){if((s.dataset??Yi)!==Yi||s.year!==t||s.virus!==ft)continue;const l=Number(s.week);if(!Number.isFinite(l))continue;const a=Number(s.cases??0);n.set(l,(n.get(l)??0)+(Number.isFinite(a)?a:0))}return Array.from(n.entries()).sort((s,l)=>de(s[0],l[0])).map(([s,l])=>({week:s,label:me(s),cases:l}))}function pi(i,t){const n=new Map;for(const s of i.sariWeekly){if(s.year!==t)continue;const l=Number(s.week);if(!Number.isFinite(l))continue;const a=Number(s.admissions??0),d=Number(s.icu??0),u=n.get(l)??{admissions:0,icu:0};u.admissions+=Number.isFinite(a)?a:0,u.icu+=Number.isFinite(d)?d:0,n.set(l,u)}return Array.from(n.entries()).sort((s,l)=>de(s[0],l[0])).map(([s,l])=>({week:s,label:me(s),admissions:l.admissions,icu:l.icu}))}function Vs(i){const t=new Set(i.years);for(const n of i.weekly)t.add(Number(n.year));for(const n of i.sariWeekly)t.add(Number(n.year));return Array.from(t).filter(n=>Number.isFinite(n)).sort((n,s)=>n-s)}function xe(i,t){const n=new Map;for(const s of i){const l=Number(s.week);if(!Number.isFinite(l))continue;const a=Number(t(s));Number.isFinite(a)&&n.set(l,(n.get(l)??0)+a)}return n}function Ms(i){const t=new Set;for(const n of i)for(const s of n.keys())Number.isFinite(s)&&t.add(s);return Array.from(t).sort((n,s)=>de(n,s))}function Ps(i,t,n){for(let s=n.length-1;s>=0;s-=1){const l=n[s],a=i.get(l),d=t.get(l);if(!(typeof a!="number"||typeof d!="number")&&!(!Number.isFinite(a)||!Number.isFinite(d)||a===0))return(d-a)/a*100}return null}function Ne(){return{points:[],latestDeltaPercent:null}}function ti(i,t,n){return{points:n.map(l=>{const a=i.has(l)?i.get(l)??null:null,d=t.has(l)?t.get(l)??null:null,u=typeof a=="number"?a:null,h=typeof d=="number"?d:null,g=u!=null&&h!=null&&Number.isFinite(u)&&Number.isFinite(h)&&u!==0?(h-u)/u*100:null;return{week:l,label:me(l),previous:a,current:d,deltaPercent:g}}),latestDeltaPercent:Ps(i,t,n)}}function Bs(i,t,n,s){const l=s.includes(n-1)?n-1:null,a=hi(t,n),d=l==null?null:hi(t,l);if(l==null)return{available:!1,compareYear:null,compareSeasonLabel:null,currentSeasonLabel:a,ili:Ne(),sariAdmissions:Ne(),sariIcu:Ne()};const u=mi(i,l),h=mi(i,n),g=pi(i,l),b=pi(i,n),T=xe(u,x=>x.cases),f=xe(h,x=>x.cases),p=xe(g,x=>x.admissions),$=xe(b,x=>x.admissions),m=xe(g,x=>x.icu),S=xe(b,x=>x.icu),y=Ms([T,f,p,$,m,S]);return y.length?{available:!0,compareYear:l,compareSeasonLabel:d,currentSeasonLabel:a,ili:ti(T,f,y),sariAdmissions:ti(p,$,y),sariIcu:ti(m,S,y)}:{available:!1,compareYear:l,compareSeasonLabel:d,currentSeasonLabel:a,ili:Ne(),sariAdmissions:Ne(),sariIcu:Ne()}}function Hs(i,t){const{respiratoryData:n,seasonLabels:s}=i,l=Vs(n),a=l.length?l[l.length-1]:new Date().getFullYear(),d=typeof t=="number"&&Number.isFinite(t)&&l.includes(t)?t:a,u=mi(n,d),h=pi(n,d),g=Ws(n,d),b=Ds(n),T=Bs(n,s,d,l),f=u.reduce((x,E)=>x+E.cases,0),p=u.reduce((x,E)=>!x||E.cases>x.cases?E:x,null),$=u.length?u[u.length-1]:null,m=h.length?h[h.length-1]:null,S=(()=>{if(u.length<2)return null;for(let x=1;x<u.length;x+=1)if(u[x].cases>=De&&u[x-1].cases<De)return u[x].week;return null})(),y=[];return u.length||y.push("No ILI rows for this season in loaded source."),h.length||y.push("No SARI rows for this season in loaded source."),g.available||y.push("No virology rows for this season in loaded source."),b.available||y.push("No EU/EEA ERVISS rows available."),i.note&&y.push(i.note),{selectedYear:d,seasonLabel:hi(s,d),availableYears:l,iliThreshold:De,iliSeries:u,sariSeries:h,virology:g,euVirology:b,historical:T,stats:{totalIliCases:f,peakIliWeek:(p==null?void 0:p.week)??null,peakIliCases:(p==null?void 0:p.cases)??null,latestWeek:($==null?void 0:$.week)??(m==null?void 0:m.week)??null,latestIliCases:($==null?void 0:$.cases)??0,latestSariAdmissions:(m==null?void 0:m.admissions)??null,latestSariIcu:(m==null?void 0:m.icu)??null,weeksAboveIliThreshold:u.filter(x=>x.cases>=De).length,firstIliThresholdCrossingWeek:S},warnings:y}}const Us="modulepreload",Ys=function(i,t){return new URL(i,t).href},Gi={},kt=function(t,n,s){let l=Promise.resolve();if(n&&n.length>0){const d=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),h=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));l=Promise.allSettled(n.map(g=>{if(g=Ys(g,s),g in Gi)return;Gi[g]=!0;const b=g.endsWith(".css"),T=b?'[rel="stylesheet"]':"";if(!!s)for(let $=d.length-1;$>=0;$--){const m=d[$];if(m.href===g&&(!b||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${T}`))return;const p=document.createElement("link");if(p.rel=b?"stylesheet":Us,b||(p.as="script"),p.crossOrigin="",p.href=g,h&&p.setAttribute("nonce",h),document.head.appendChild(p),b)return new Promise(($,m)=>{p.addEventListener("load",$),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return l.then(d=>{for(const u of d||[])u.status==="rejected"&&a(u.reason);return t().catch(a)})},_s="NNGYK",Ki="ILI (flu-like illness)";function X(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function U(i){const t=typeof i=="number"?i:Number(i);return Number.isFinite(t)?t:null}function fi(i){if(typeof i!="string")return null;const t=i.trim();return t.length?t:null}function Ae(i){const t=fi(i);if(!t)return Ki;const n=t.normalize("NFKC").replace(/\u00a0/g," ").replace(/\s+/g," ").trim();return/^ili\s*\(\s*flu[-\s]*like illness\s*\)$/i.test(n)?Ki:/^influenza$/i.test(n)?"Influenza":/^influenza\s+a$/i.test(n)?"Influenza A":/^influenza\s+b$/i.test(n)?"Influenza B":/^influenza\s+untyped$/i.test(n)?"Influenza (untyped)":/^influenza\s+a\s*\(\s*h1n1pdm09\s*\)$/i.test(n)||/^influenza\s+a\s*\(\s*h1pdm09\s*\)$/i.test(n)||/^a\s*\(\s*h1\s*\)\s*pdm09$/i.test(n)?"Influenza A(H1N1pdm09)":/^influenza\s+a\s*\(\s*h3\s*\)$/i.test(n)||/^a\s*\(\s*h3\s*\)$/i.test(n)?"Influenza A(H3)":/^influenza\s+a\s*\(\s*nt\s*\)$/i.test(n)||/^a\s*\(\s*unknown\s*\)$/i.test(n)?"Influenza A(NT)":/^sars[-\s]*cov[-\s]*2$/i.test(n)?"SARS-CoV-2":/^rs[-\s]*v(i[íi]rus)?$/i.test(n)?"RSV":n}function Ve(i){const t=Number(String(i).replace(",","."));return!Number.isFinite(t)||t<0||t>100?null:t}function Os(i){var g;if(typeof i!="string")return null;const t=i.normalize("NFKC").replace(/\u00a0/g," ").replace(/\s+/g," ").trim();if(!t)return null;const n=((g=/Az influenzaszer[űu] megbeteged[ée]s[\s\S]{0,560}/i.exec(t))==null?void 0:g[0])??t.slice(0,900),s=/(\d{1,2}(?:[.,]\d+)?)%\S*\s*0-14[\s\S]{0,140}?(\d{1,2}(?:[.,]\d+)?)%\S*\s*15-34[\s\S]{0,140}?(\d{1,2}(?:[.,]\d+)?)%\S*[\s\S]{0,140}?35-59[\s\S]{0,140}?(\d{1,2}(?:[.,]\d+)?)%\S*[\s\S]{0,140}?60/i.exec(n);if(!s)return null;const l=Ve(s[1]),a=Ve(s[2]),d=Ve(s[3]),u=Ve(s[4]);if(l==null||a==null||d==null||u==null)return null;const h=l+a+d+u;return h<85||h>115?null:{age0to14:l,age15to34:a,age35to59:d,age60plus:u}}function qi(i){return i>=40?i:i+53}function ze(i,t){return qi(i)-qi(t)}function bi(i){try{return null}catch{return null}}async function St(i){try{const t=await fetch(i,{cache:"no-cache"});return t.ok?await t.json():null}catch{return null}}async function Gs(){const i=bi("../../nngyk_all.json"),t=["./nngyk_all.json","/nngyk_all.json",...i?[i]:[]];for(const n of t){const s=await St(n);if(s!=null)return{payload:s,location:n}}try{return{payload:(await kt(()=>import("./nngyk_all-6WdLRqwI.js"),[],import.meta.url)).default,location:"@nngyk-all"}}catch{return null}}async function Ks(){const t=["./erviss_data/erviss_sari.json","/erviss_data/erviss_sari.json","./erviss_sari.json","/erviss_sari.json",...[bi("../../erviss_data/erviss_sari.json"),bi("../../erviss_sari.json")].filter(n=>typeof n=="string")];for(const n of t){const s=await St(n);if(s!=null)return{payload:s,location:n}}try{return{payload:(await kt(()=>import("./erviss_sari-Cp4hlEJI.js"),[],import.meta.url)).default,location:"@erviss-sari"}}catch{return null}}function qs(i,t){if(!Array.isArray(i))return null;const n=new Map,s=new Map,l=new Map,a=new Map,d=new Map,u=new Set,h=new Set;for(const f of i){if(!X(f))continue;const p=X(f.payload)?f.payload:null;if(!p)continue;const $=Array.isArray(p.weekly)?p.weekly:[],m=X(p.metadata)?p.metadata:null,S=U(f.season_year)??U(m==null?void 0:m.season_year)??U(X($[0])?$[0].year:null),y=U(f.week)??U(X($[0])?$[0].week:null);if(S!=null&&y!=null){const C=Os(p.raw_text);C&&d.set(`${S}::${y}`,{year:S,week:y,...C})}for(const C of $){if(!X(C))continue;const F=U(C.year)??S,D=U(C.week)??y;if(F==null||D==null)continue;const V=fi(C.dataset)??_s,B=Ae(C.virus),q=fi(C.region)??"National",ae=U(C.cases)??0,ge=`${V}::${F}::${D}::${B}::${q}`,Se=n.get(ge);Se?Se.cases+=ae:n.set(ge,{dataset:V,year:F,week:D,virus:B,cases:ae,region:q}),u.add(F),h.add(B)}const x=X(p.sari)?p.sari:null;if(x&&S!=null){const C=U(x.week)??y,F=U(x.admissions),D=U(x.icu);if(C!=null&&(F!=null||D!=null)){const V=`${S}::${C}`,B=s.get(V)??{year:S,week:C,admissions:null,icu:null};F!=null&&(B.admissions=(B.admissions??0)+F),D!=null&&(B.icu=(B.icu??0)+D),s.set(V,B),u.add(S)}}const E=X(p.virology)?p.virology:null;if(E&&S!=null&&y!=null){const C=Array.isArray(E.detections)?E.detections:[],F=Array.isArray(E.positivity)?E.positivity:[];for(const D of C){if(!X(D))continue;const V=Ae(D.virus),B=U(D.detections);if(B==null)continue;const q=`${S}::${y}::${V}`,ae=l.get(q);ae?ae.detections+=B:l.set(q,{year:S,week:y,virus:V,detections:B})}for(const D of F){if(!X(D))continue;const V=Ae(D.virus),B=U(D.positivity);if(B==null)continue;const q=`${S}::${y}::${V}`,ae=a.get(q);(!ae||B>ae.positivity)&&a.set(q,{year:S,week:y,virus:V,positivity:B})}}}if(!n.size)return null;const g={},b=Array.from(u).sort((f,p)=>f-p);for(const f of b)g[String(f)]=`${f}-${f+1}`;return{source:"nngyk_all",respiratoryData:yi.parse({years:b,weekly:Array.from(n.values()).sort((f,p)=>f.year-p.year||ze(f.week,p.week)||f.virus.localeCompare(p.virus)),sariWeekly:Array.from(s.values()).sort((f,p)=>f.year-p.year||ze(f.week,p.week)),virologyDetections:Array.from(l.values()).sort((f,p)=>f.year-p.year||ze(f.week,p.week)||f.virus.localeCompare(p.virus)),virologyPositivity:Array.from(a.values()).sort((f,p)=>f.year-p.year||ze(f.week,p.week)||f.virus.localeCompare(p.virus)),ervissDetections:[],ervissPositivity:[],viruses:Array.from(h).sort((f,p)=>f.localeCompare(p)),datasets:{NNGYK:{name:"NNGYK (Hungary)",description:"Structured from parsed NNGYK bulletins (latest run)."}}}),seasonLabels:g,iliAgeSplits:Array.from(d.values()).sort((f,p)=>f.year-p.year||ze(f.week,p.week)),note:`Loaded live bulletin extract from ${t}.`}}function vi(i,t){const n=i.note?`${i.note} ${t}`:t;return{...i,note:n}}function Qs(i,t,n){if(!X(t))return null;const s=U(t.latest_year),l=Array.isArray(t.detections)?t.detections:[],a=Array.isArray(t.positivity)?t.positivity:[],d=l.map(g=>{if(!X(g))return null;const b=U(g.year)??s,T=U(g.week),f=U(g.detections),p=Ae(g.virus);return b==null||T==null||f==null||!p?null:{year:b,week:T,virus:p,detections:f}}).filter(g=>g!==null).sort((g,b)=>g.year-b.year||g.week-b.week||g.virus.localeCompare(b.virus)),u=a.map(g=>{if(!X(g))return null;const b=U(g.year)??s,T=U(g.week),f=U(g.positivity),p=Ae(g.virus);return b==null||T==null||f==null||!p?null:{year:b,week:T,virus:p,positivity:f}}).filter(g=>g!==null).sort((g,b)=>g.year-b.year||g.week-b.week||g.virus.localeCompare(b.virus));if(!d.length&&!u.length)return null;const h=yi.parse({...i.respiratoryData,ervissDetections:d,ervissPositivity:u,datasets:{...X(i.respiratoryData.datasets)?i.respiratoryData.datasets:{},ERVISS:{name:"ERVISS (EU/EEA)",description:"EU/EEA SARI virological detections and positivity from ECDC ERVISS."}}});return vi({...i,respiratoryData:h},`Loaded ERVISS feed from ${n}.`)}async function Zs(){const i=await Gs();let t;i?t=qs(i.payload,i.location)??He("nngyk_all.json present but invalid for weekly aggregation; using bundled sample."):t=He("nngyk_all.json not found; using bundled sample.");const n=await Ks();if(!n)return vi(t,"ERVISS feed not found.");const s=Qs(t,n.payload,n.location);return s||vi(t,"ERVISS feed present but invalid.")}const Qi=new Intl.NumberFormat("en-US");function Js(i,t="W"){const n=String(i).padStart(2,"0");return t==="W"?`W${n}`:`${t}${n}`}function Xs(i,t){const n=/^W(\d{1,2})$/i.exec(String(i??"").trim());if(!n)return i;const s=String(n[1]).padStart(2,"0");return t==="W"?`W${s}`:`${t}${s}`}function en({points:i,threshold:t,compact:n,dark:s=!1,labels:l}){const a=s?{axisLine:"rgba(148, 163, 184, 0.45)",axisLabel:"#cbd5e1",legend:"#e2e8f0",grid:"rgba(148, 163, 184, 0.16)",markerLine:"rgba(148, 163, 184, 0.38)",markerLabel:"#cbd5e1",markerBg:"rgba(15, 23, 42, 0.88)",currentWeekLine:"rgba(125, 211, 252, 0.55)",sliderBorder:"rgba(148, 163, 184, 0.35)",sliderFill:"rgba(59, 130, 246, 0.35)",sliderText:"#cbd5e1",legendBg:"rgba(15, 23, 42, 0.82)",legendBorder:"rgba(148, 163, 184, 0.32)",tooltipBg:"rgba(15, 23, 42, 0.96)",tooltipBorder:"rgba(148, 163, 184, 0.48)",tooltipText:"#e2e8f0"}:{axisLine:"rgba(15, 23, 42, 0.20)",axisLabel:"#334155",legend:"#0f172a",grid:"rgba(15, 23, 42, 0.1)",markerLine:"rgba(15, 23, 42, 0.16)",markerLabel:"#64748b",markerBg:"rgba(255, 255, 255, 0.85)",currentWeekLine:"rgba(37, 99, 235, 0.45)",sliderBorder:"rgba(15, 23, 42, 0.18)",sliderFill:"rgba(37, 99, 235, 0.20)",sliderText:"#475569",legendBg:"rgba(248, 250, 252, 0.92)",legendBorder:"rgba(148, 163, 184, 0.38)",tooltipBg:"rgba(15, 23, 42, 0.94)",tooltipBorder:"rgba(30, 41, 59, 0.24)",tooltipText:"#f8fafc"},d=l??{iliCases:"ILI cases",alertThreshold:"Alert threshold",crossing:"Threshold crossing",noData:"No data",seasonStart:"Season start",holidays:"Holiday period"},u=(l==null?void 0:l.weekPrefix)??"W",h=[{week:40,text:d.seasonStart},{week:52,text:d.holidays},{week:1,text:d.holidays}],b=i.map(y=>y.label).map(y=>Xs(y,u)),T=i.map(y=>y.cases),f=b.length>0,p=f?b[b.length-1]:null,$=h.map(y=>{const x=Js(y.week,u);return b.includes(x)?{name:y.text,xAxis:x}:null}).filter(y=>y!==null),m=[{name:d.iliCases,type:"line",data:f?T:[0],smooth:.24,showSymbol:!1,symbol:"circle",symbolSize:7,lineStyle:{width:3,color:s?"#7dd3fc":"#2563eb",cap:"round"},areaStyle:{color:new gi(0,0,0,1,[{offset:0,color:s?"rgba(125, 211, 252, 0.42)":"rgba(59, 130, 246, 0.28)"},{offset:1,color:s?"rgba(56, 189, 248, 0.06)":"rgba(147, 197, 253, 0.03)"}])},emphasis:{focus:"series",lineStyle:{width:3.6}},markLine:p?{symbol:["none","none"],silent:!0,lineStyle:{color:a.currentWeekLine,width:1.3,type:"dashed"},label:{show:!1},data:[{xAxis:p}]}:void 0,z:3},{name:d.alertThreshold,type:"line",data:f?b.map(()=>t):[t],symbol:"none",itemStyle:{color:"#dc2626"},lineStyle:{color:"#dc2626",type:"dashed",width:2},emphasis:{lineStyle:{color:"#dc2626",width:2.2}},markLine:$.length?{symbol:["none","none"],silent:!0,lineStyle:{color:a.markerLine,width:1,type:"solid"},label:{color:a.markerLabel,formatter:"{b}",position:"insideStartTop",padding:[2,4],backgroundColor:a.markerBg,borderRadius:4},data:$}:void 0,z:5}];let S;if(n&&b.length>12){const y=Math.max(0,b.length-12);S=[{type:"inside",xAxisIndex:0,startValue:b[y],endValue:b[b.length-1]},{type:"slider",xAxisIndex:0,bottom:8,height:18,startValue:b[y],endValue:b[b.length-1],brushSelect:!1,showDataShadow:!1,borderColor:a.sliderBorder,fillerColor:a.sliderFill,moveHandleSize:6,textStyle:{color:a.sliderText}}]}return{animation:!1,aria:{enabled:!0},grid:{top:n?42:78,right:20,bottom:n&&S?58:36,left:54},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:a.currentWeekLine,type:"dashed",width:1.1}},backgroundColor:a.tooltipBg,borderColor:a.tooltipBorder,borderWidth:1,textStyle:{color:a.tooltipText,fontWeight:600},extraCssText:"box-shadow: 0 14px 30px rgba(2, 6, 23, 0.28);",formatter:y=>{const x=Array.isArray(y)?y:[];if(!x.length)return"";const C=x[0].axisValueLabel??"",F=x.filter(D=>D.seriesName!==d.crossing).map(D=>{const V=D,B=Array.isArray(V.data)?V.data[1]:V.data,q=typeof B=="number"&&Number.isFinite(B)?Qi.format(B):"–";return`${V.marker??""} ${V.seriesName??""}: ${q}`}).join("<br/>");return F?`${C}<br/>${F}`:C}},legend:{show:!n,top:2,left:8,right:8,data:[d.iliCases,d.alertThreshold],itemWidth:14,itemHeight:8,itemGap:12,padding:[6,10],backgroundColor:a.legendBg,borderColor:a.legendBorder,borderWidth:1,borderRadius:10,textStyle:{color:a.legend,fontSize:12,lineHeight:16,fontWeight:600},icon:"circle"},xAxis:{type:"category",data:f?b:[d.noData],boundaryGap:!1,axisTick:{show:!1},axisLine:{lineStyle:{color:a.axisLine}},axisLabel:{color:a.axisLabel,interval:n?"auto":0,hideOverlap:!0}},yAxis:{type:"value",min:0,axisLabel:{color:a.axisLabel,formatter:y=>Qi.format(y)},splitLine:{lineStyle:{color:a.grid,type:[4,5]}}},dataZoom:S,series:m}}const Zi=new Intl.NumberFormat("en-US");function Ji(i,t){const n=/^W(\d{1,2})$/i.exec(String(i??"").trim());if(!n)return i;const s=String(n[1]).padStart(2,"0");return t==="hu"?`H${s}`:`W${s}`}function he(i){if(i==null||!Number.isFinite(i))return"–";const t=Math.round(i*10)/10;return`${t>0?"+":""}${t.toLocaleString(void 0,{maximumFractionDigits:1})}%`}function si({metric:i,compareSeasonLabel:t,currentSeasonLabel:n,compact:s,dark:l=!1,language:a="en",labels:d}){const u=l?{axisLine:"rgba(148, 163, 184, 0.45)",axisLabel:"#cbd5e1",legend:"#e2e8f0",grid:"rgba(148, 163, 184, 0.16)",baseline:"rgba(203, 213, 225, 0.58)",sliderBorder:"rgba(148, 163, 184, 0.35)",sliderFill:"rgba(59, 130, 246, 0.35)",sliderText:"#cbd5e1",legendBg:"rgba(15, 23, 42, 0.82)",legendBorder:"rgba(148, 163, 184, 0.32)",currentWeekLine:"rgba(125, 211, 252, 0.55)",tooltipBg:"rgba(15, 23, 42, 0.96)",tooltipBorder:"rgba(148, 163, 184, 0.48)",tooltipText:"#e2e8f0"}:{axisLine:"rgba(15, 23, 42, 0.20)",axisLabel:"#334155",legend:"#0f172a",grid:"rgba(15, 23, 42, 0.1)",baseline:"rgba(15, 23, 42, 0.52)",sliderBorder:"rgba(15, 23, 42, 0.18)",sliderFill:"rgba(37, 99, 235, 0.20)",sliderText:"#475569",legendBg:"rgba(248, 250, 252, 0.92)",legendBorder:"rgba(148, 163, 184, 0.38)",currentWeekLine:"rgba(37, 99, 235, 0.45)",tooltipBg:"rgba(15, 23, 42, 0.94)",tooltipBorder:"rgba(30, 41, 59, 0.24)",tooltipText:"#f8fafc"},h=d??{noData:"No data"},g=i.points.map(m=>m.label),b=i.points.map(m=>m.previous),T=i.points.map(m=>m.current),f=g.length>0,p=f?g[g.length-1]:null;let $;if(s&&g.length>12){const m=g[0],S=g[g.length-1];$=[{type:"inside",xAxisIndex:0,startValue:m,endValue:S},{type:"slider",xAxisIndex:0,bottom:8,height:18,startValue:m,endValue:S,brushSelect:!1,showDataShadow:!1,borderColor:u.sliderBorder,fillerColor:u.sliderFill,moveHandleSize:6,textStyle:{color:u.sliderText}}]}return{animation:!1,aria:{enabled:!0},grid:{top:s?36:72,right:18,bottom:s&&$?58:46,left:50},tooltip:{trigger:"axis",backgroundColor:u.tooltipBg,borderColor:u.tooltipBorder,borderWidth:1,textStyle:{color:u.tooltipText,fontWeight:600},extraCssText:"box-shadow: 0 14px 30px rgba(2, 6, 23, 0.28);",formatter:m=>{const S=Array.isArray(m)?m:[];if(!S.length)return"";const y=S[0],x=Ji(y.axisValueLabel??"",a),E=S.map(C=>{const F=C,D=typeof F.data=="number"&&Number.isFinite(F.data)?Zi.format(F.data):"–";return`${F.marker??""} ${F.seriesName??""}: ${D}`}).join("<br/>");return`${x}<br/>${E}`}},legend:{show:!s,top:2,left:8,right:8,itemWidth:12,itemHeight:8,itemGap:10,padding:[6,10],backgroundColor:u.legendBg,borderColor:u.legendBorder,borderWidth:1,borderRadius:10,textStyle:{color:u.legend,fontSize:12,lineHeight:16,fontWeight:600}},xAxis:{type:"category",data:f?g:[h.noData],axisLine:{lineStyle:{color:u.axisLine}},axisLabel:{color:u.axisLabel,interval:s?"auto":0,hideOverlap:!0,formatter:m=>Ji(String(m),a)}},yAxis:{type:"value",min:0,axisLabel:{color:u.axisLabel,formatter:m=>Zi.format(m)},splitLine:{lineStyle:{color:u.grid,type:[4,5]}}},dataZoom:$,series:[{name:t,type:"line",data:f?b:[null],smooth:.25,connectNulls:!1,symbolSize:5,lineStyle:{color:u.baseline,width:2},itemStyle:{color:u.baseline},markLine:p?{symbol:["none","none"],silent:!0,lineStyle:{color:u.currentWeekLine,width:1.3,type:"dashed"},label:{show:!1},data:[{xAxis:p}]}:void 0},{name:n,type:"line",data:f?T:[null],smooth:.25,connectNulls:!1,symbolSize:5,lineStyle:{color:"#2563eb",width:2.4},itemStyle:{color:"#2563eb"}}]}}const Xi=new Intl.NumberFormat("en-US"),tn=new Intl.NumberFormat("en-US",{maximumFractionDigits:1});function et(i){return i>=40?i:i+53}function xt(i,t){return et(i)-et(t)}function Nt(i,t){return i-t}function wt(i,t){const n=String(i).padStart(2,"0");return t==="hu"?`H${n}`:`W${n}`}const sn={"ILI (flu-like illness)":"Influenzaszerű megbetegedés (ILI)",Influenza:"Influenza","Influenza A":"Influenza A","Influenza B":"Influenza B","Influenza A(H1N1pdm09)":"Influenza A(H1N1pdm09)","Influenza A(H3)":"Influenza A(H3)","Influenza A(NT)":"Influenza A(NT)",RSV:"RSV","SARS-CoV-2":"SARS-CoV-2",[ie]:"Influenza (összes)"},nn={influenza:{light:"#ec4899",dark:"#f472b6"},sarscov2:{light:"#2563eb",dark:"#60a5fa"},rsv:{light:"#14b8a6",dark:"#2dd4bf"},hmpv:{light:"#f97316",dark:"#fb923c"}},it={light:["#8b5cf6","#0ea5e9","#ef4444","#84cc16","#f59e0b"],dark:["#a78bfa","#38bdf8","#f87171","#a3e635","#fbbf24"]};function rn(i){let t=0;for(let n=0;n<i.length;n+=1)t=t*31+i.charCodeAt(n)>>>0;return t}function an(i){const t=String(i??"").trim().toLowerCase();return t?t===ie.toLowerCase()||t.includes("influenza")||t.includes("flu-like")||t.startsWith("ili")?"influenza":t.includes("sars")||t.includes("cov")?"sarscov2":/\brsv\b/.test(t)?"rsv":t.includes("hmpv")||t.includes("metapneumo")?"hmpv":"other":"other"}function Lt(i,t=!1){const n=an(i);if(n!=="other"){const a=nn[n];return t?a.dark:a.light}const s=t?it.dark:it.light,l=String(i??"").trim()||"other";return s[rn(l)%s.length]}function J(i,t="en"){return t==="hu"?sn[i]??i:i===ie?"Influenza (all)":i}function jt(i,t,n){if(!t||i.length<=12)return;const s=Math.max(0,i.length-12);return[{type:"inside",xAxisIndex:0,startValue:i[s],endValue:i[i.length-1]},{type:"slider",xAxisIndex:0,bottom:8,height:18,startValue:i[s],endValue:i[i.length-1],brushSelect:!1,showDataShadow:!1,borderColor:n.sliderBorder,fillerColor:n.sliderFill,moveHandleSize:6,textStyle:{color:n.sliderText}}]}function tt({rows:i,selectedVirus:t,compact:n,weekOrder:s="season",language:l="en",dark:a=!1}){const d=a?{axisLine:"rgba(148, 163, 184, 0.45)",axisLabel:"#cbd5e1",legend:"#e2e8f0",grid:"rgba(148, 163, 184, 0.16)",sliderBorder:"rgba(148, 163, 184, 0.35)",sliderFill:"rgba(59, 130, 246, 0.35)",sliderText:"#cbd5e1",legendBg:"rgba(15, 23, 42, 0.82)",legendBorder:"rgba(148, 163, 184, 0.32)",legendPage:"#93c5fd",currentWeekLine:"rgba(125, 211, 252, 0.55)",tooltipBg:"rgba(15, 23, 42, 0.96)",tooltipBorder:"rgba(148, 163, 184, 0.48)",tooltipText:"#e2e8f0"}:{axisLine:"rgba(15, 23, 42, 0.20)",axisLabel:"#334155",legend:"#0f172a",grid:"rgba(15, 23, 42, 0.1)",sliderBorder:"rgba(15, 23, 42, 0.18)",sliderFill:"rgba(37, 99, 235, 0.20)",sliderText:"#475569",legendBg:"rgba(248, 250, 252, 0.92)",legendBorder:"rgba(148, 163, 184, 0.38)",legendPage:"#1d4ed8",currentWeekLine:"rgba(37, 99, 235, 0.45)",tooltipBg:"rgba(15, 23, 42, 0.94)",tooltipBorder:"rgba(30, 41, 59, 0.24)",tooltipText:"#f8fafc"},u=s==="numeric"?Nt:xt,h=Array.from(new Set(i.map(m=>m.week))).sort((m,S)=>u(m,S)),g=h.map(m=>wt(m,l)),b=l==="hu"?"Nincs adat":"No data",T=t===ke?Array.from(new Set(i.map(m=>m.virus))).sort((m,S)=>m===ie?-1:S===ie?1:m.localeCompare(S)):[t],f=jt(g,n,d),p=g.length?g[g.length-1]:null,$=T.map((m,S)=>{const y=new Map;for(const E of i)E.virus===m&&y.set(E.week,E.detections);const x=Lt(m,a);return{name:J(m,l),type:"line",data:h.map(E=>y.get(E)??null),smooth:.25,connectNulls:!1,symbolSize:5,lineStyle:{color:x,width:2.2},itemStyle:{color:x},markLine:S===0&&p?{symbol:["none","none"],silent:!0,lineStyle:{color:d.currentWeekLine,width:1.3,type:"dashed"},label:{show:!1},data:[{xAxis:p}]}:void 0}});return{animation:!1,aria:{enabled:!0},grid:{top:n?40:90,right:18,bottom:n&&f?58:36,left:48},tooltip:{trigger:"axis",backgroundColor:d.tooltipBg,borderColor:d.tooltipBorder,borderWidth:1,textStyle:{color:d.tooltipText,fontWeight:600},extraCssText:"box-shadow: 0 14px 30px rgba(2, 6, 23, 0.28);",formatter:m=>{const S=Array.isArray(m)?m:[];if(!S.length)return"";const y=S[0].axisValueLabel??"",x=S.map(E=>{const C=E,F=typeof C.data=="number"&&Number.isFinite(C.data)?Xi.format(C.data):"–";return`${C.marker??""} ${C.seriesName??""}: ${F}`}).join("<br/>");return`${y}<br/>${x}`}},legend:{show:!n,type:"scroll",top:4,left:8,right:8,itemWidth:10,itemHeight:10,itemGap:10,padding:[6,10],backgroundColor:d.legendBg,borderColor:d.legendBorder,borderWidth:1,borderRadius:10,pageIconColor:d.legendPage,pageIconInactiveColor:d.axisLine,pageTextStyle:{color:d.axisLabel},textStyle:{color:d.legend,fontWeight:600,fontSize:12,lineHeight:16}},xAxis:{type:"category",data:g.length?g:[b],axisLine:{lineStyle:{color:d.axisLine}},axisLabel:{color:d.axisLabel,interval:n?"auto":0,hideOverlap:!0}},yAxis:{type:"value",min:0,axisLabel:{color:d.axisLabel,formatter:m=>Xi.format(m)},splitLine:{lineStyle:{color:d.grid,type:[4,5]}}},dataZoom:f,series:$}}function st({rows:i,compact:t,weekOrder:n="season",language:s="en",dark:l=!1}){const a=l?{axisLine:"rgba(148, 163, 184, 0.45)",axisLabel:"#cbd5e1",legend:"#e2e8f0",grid:"rgba(148, 163, 184, 0.16)",sliderBorder:"rgba(148, 163, 184, 0.35)",sliderFill:"rgba(59, 130, 246, 0.35)",sliderText:"#cbd5e1",legendBg:"rgba(15, 23, 42, 0.82)",legendBorder:"rgba(148, 163, 184, 0.32)",legendPage:"#93c5fd",currentWeekLine:"rgba(125, 211, 252, 0.55)",tooltipBg:"rgba(15, 23, 42, 0.96)",tooltipBorder:"rgba(148, 163, 184, 0.48)",tooltipText:"#e2e8f0"}:{axisLine:"rgba(15, 23, 42, 0.20)",axisLabel:"#334155",legend:"#0f172a",grid:"rgba(15, 23, 42, 0.1)",sliderBorder:"rgba(15, 23, 42, 0.18)",sliderFill:"rgba(37, 99, 235, 0.20)",sliderText:"#475569",legendBg:"rgba(248, 250, 252, 0.92)",legendBorder:"rgba(148, 163, 184, 0.38)",legendPage:"#1d4ed8",currentWeekLine:"rgba(37, 99, 235, 0.45)",tooltipBg:"rgba(15, 23, 42, 0.94)",tooltipBorder:"rgba(30, 41, 59, 0.24)",tooltipText:"#f8fafc"},d=n==="numeric"?Nt:xt,u=Array.from(new Set(i.map(m=>m.week))).sort((m,S)=>d(m,S)),h=u.map(m=>wt(m,s)),g=s==="hu"?"Nincs adat":"No data",b=s==="hu"?" pozitivitás":" positivity",T=Array.from(new Set(i.map(m=>m.virus))).sort((m,S)=>m.localeCompare(S)),f=jt(h,t,a),p=h.length?h[h.length-1]:null,$=T.map((m,S)=>{const y=new Map;for(const E of i)E.virus===m&&y.set(E.week,E.positivity);const x=Lt(m,l);return{name:`${J(m,s)}${b}`,type:"line",data:u.map(E=>y.get(E)??null),smooth:.25,connectNulls:!1,symbolSize:5,lineStyle:{color:x,width:2.2},itemStyle:{color:x},markLine:S===0&&p?{symbol:["none","none"],silent:!0,lineStyle:{color:a.currentWeekLine,width:1.3,type:"dashed"},label:{show:!1},data:[{xAxis:p}]}:void 0}});return{animation:!1,aria:{enabled:!0},grid:{top:t?40:90,right:18,bottom:t&&f?58:36,left:48},tooltip:{trigger:"axis",backgroundColor:a.tooltipBg,borderColor:a.tooltipBorder,borderWidth:1,textStyle:{color:a.tooltipText,fontWeight:600},extraCssText:"box-shadow: 0 14px 30px rgba(2, 6, 23, 0.28);",formatter:m=>{const S=Array.isArray(m)?m:[];if(!S.length)return"";const y=S[0].axisValueLabel??"",x=S.map(E=>{const C=E,F=typeof C.data=="number"&&Number.isFinite(C.data)?`${tn.format(C.data)}%`:"–";return`${C.marker??""} ${C.seriesName??""}: ${F}`}).join("<br/>");return`${y}<br/>${x}`}},legend:{show:!t,type:"scroll",top:4,left:8,right:8,itemWidth:10,itemHeight:10,itemGap:10,padding:[6,10],backgroundColor:a.legendBg,borderColor:a.legendBorder,borderWidth:1,borderRadius:10,pageIconColor:a.legendPage,pageIconInactiveColor:a.axisLine,pageTextStyle:{color:a.axisLabel},textStyle:{color:a.legend,fontWeight:600,fontSize:12,lineHeight:16}},xAxis:{type:"category",data:h.length?h:[g],axisLine:{lineStyle:{color:a.axisLine}},axisLabel:{color:a.axisLabel,interval:t?"auto":0,hideOverlap:!0}},yAxis:{type:"value",min:0,axisLabel:{color:a.axisLabel,formatter:m=>`${m}%`},splitLine:{lineStyle:{color:a.grid,type:[4,5]}}},dataZoom:f,series:$}}cs([ds,gs,hs,ms,ps,fs,bs,vs,ys,ks,Ss]);function ce({title:i,subtitle:t,option:n}){const s=N.useRef(null),l=N.useRef(null);return N.useEffect(()=>{const a=s.current;if(!a)return;l.current||(l.current=us(a,void 0,{renderer:"canvas"})),l.current.setOption(n,{notMerge:!0,lazyUpdate:!0}),l.current.resize();const d=()=>{var h;return(h=l.current)==null?void 0:h.resize()};let u=null;return typeof ResizeObserver<"u"?(u=new ResizeObserver(()=>d()),u.observe(a)):window.addEventListener("resize",d),()=>{if(u){u.disconnect();return}window.removeEventListener("resize",d)}},[n]),N.useEffect(()=>()=>{var a;(a=l.current)==null||a.dispose(),l.current=null},[]),e.jsxs("article",{className:"panel",children:[e.jsxs("header",{className:"panel-header",children:[e.jsx("h2",{children:i}),t?e.jsx("p",{children:t}):null]}),e.jsx("div",{className:"panel-chart",ref:s})]})}const Me="NNGYK",ye="ILI (flu-like illness)",nt="rvd-lang",rt="rvd-theme",on=96e5,ln={en:{appTitle:"Seasonal Respiratory Pathogen Dashboard",appSubtitle:"Hungarian and European situation overview based on NNGYK and ECDC data",season:"Season",language:"Language",theme:"Theme",themeSystem:"System",themeDark:"Dark",themeLight:"Light",sectionCollapse:"Collapse",sectionExpand:"Expand",sourceTitle:"Data source",sourceLive:"Live source: nngyk_all.json",sourceFallback:"Fallback source: bundled sample",sourceLoading:"loading",sectionKicker:"Section",sectionHuTitle:"Hungarian situation",sectionHuNote:"NNGYK surveillance and sentinel indicators for the selected season.",sectionEuTitle:"European (EU/EEA) context",sectionEuNote:"ECDC ERVISS sentinel virology indicators.",alertsAria:"Key alerts",signalTitle:"Seasonal influenza threshold",signalEpidemicYes:"Influenza epidemic ongoing",signalEpidemicNo:"No influenza epidemic",signalAbove:"Above threshold",signalBelow:"Below threshold",fluTextAbove:"{week}: ILI activity ({cases} estimated cases) is above the alert threshold ({threshold}).",fluTextBelow:"{week}: ILI activity ({cases} estimated cases) remains below the alert threshold ({threshold}).",fluChipAbove:"Epidemic signal",fluChipBelow:"Below threshold",alertThreshold:"Alert threshold",crossingLabel:"Threshold crossing",alertsLoading:"Awaiting data",alertsLoadingPos:"Awaiting positivity data",alertsLoadingEuPos:"Awaiting EU/EEA positivity data",decisionTitle:"Weekly situation",decisionIncreasing:"Influenza activity is increasing (HU)",decisionEasing:"Influenza pressure is easing",decisionStableHigh:"Influenza pressure remains high",decisionRisingBelow:"Influenza activity is rising",decisionStableLow:"No influenza epidemic signal",decisionConfidence:"Confidence",decisionFreshness:"Updated",decisionEvidenceIli:"View ILI and SARI charts",decisionEvidenceHuPositivity:"View sentinel positivity",decisionEvidenceEuPositivity:"View EU positivity",decisionConfidenceHigh:"High",decisionConfidenceMedium:"Moderate",decisionConfidenceLow:"Limited",coverageNngyk:"Coverage · NNGYK",coverageNngykNote:"Latest ILI week in selected season",coverageSari:"Coverage · SARI",coverageSariNote:"Latest SARI week in selected season",coverageErviss:"Coverage · ERVISS",coverageErvissNote:"Latest EU/EEA reporting week",coverageMissing:"Missing weeks (ILI/SARI)",coverageMissingNote:"Gaps within each season timeline",coverageAria:"Data coverage indicators",trendTitle:"Weekly trend signals",trendNote:"Weekly change in ILI cases and sentinel positivity.",trendAria:"Weekly trend signals",trendNoRecentChange:"No notable change",trendSurging:"Surging",trendDeclining:"Declining",trendFlat:"Flat",trendEmpty:"No recent ILI or positivity trend data.",rigorTitle:"Epidemiological rigor",rigorNote:"Comparable indicators using rates, baseline z-scores, age split and data-quality signals.",rigorAria:"Epidemiological rigor indicators",rigorIliRateCard:"ILI rate (per 100k)",rigorSariRateCard:"SARI admissions rate (per 100k)",rigorWoW:"WoW",rigorZScore:"Z-score vs baseline",rigorBaselineSample:"Baseline seasons",rigorBaselineMean:"Baseline mean",rigorAgeSplitTitle:"ILI age split (latest week)",rigorAgeMissing:"Age split is unavailable in the current data source.",rigorAge0to14:"Age 0-14",rigorAge15to34:"Age 15-34",rigorAge35to59:"Age 35-59",rigorAge60plus:"Age 60+",rigorQualityTitle:"Uncertainty and data quality",rigorQualityCoverage:"Coverage",rigorQualityBaseline:"Baseline robustness",rigorQualityAge:"Age split availability",rigorQualityGood:"Good",rigorQualityModerate:"Moderate",rigorQualityLimited:"Limited",rigorPer100kSuffix:"/100k",glanceTitle:"Season at a glance",glanceNote:"Growth and burden signals alongside peak and recent trend.",glanceAria:"Season at a glance",glanceIli:"Flu-like illness",glanceSari:"SARI hospitalizations",glanceIcu:"SARI ICU",glancePeak:"Peak",glanceLatest:"Latest",glanceSlope:"3-week trend",glanceWow:"WoW change",glanceWeeksAbove:"Weeks above threshold",glanceStdTitle:"Season-to-date burden",glanceStdIli:"ILI cumulative",glanceStdSari:"SARI cumulative",glanceSeverityTitle:"Severity ratios",glanceSeveritySari:"SARI as % of ILI",glanceSeverityIcu:"ICU as % of SARI",stdNoBaseline:"No baseline",stdMedian:"Median",stdLastSeason:"Last season",statsTotalIli:"This-week ILI cases",statsPeakIli:"ILI peak week / cases",statsIliVsPrev:"Latest ILI vs previous season",statsIliVsPrevBaseline:"{season}: {value}",statsIliVsPrevNoBaseline:"No previous-season value for this week.",statsFirstCrossing:"First threshold crossing",statsWeeksAbove:"Weeks above threshold",statsLatestSari:"This-week hospital SARI/ICU",statsAgeSplit:"This-week ILI age split",chartIli:"Flu-like illness",chartIliSubtitle:"Season {season} (threshold {threshold})",chartSari:"SARI hospital admissions",chartSariSubtitle:"Season {season}",leaderHuTitle:"Leading virus by positivity in Hungary",leaderEuTitle:"Leading virus by positivity in the EU/EEA",leaderHuText:"{week}: {virus} shows the highest sentinel positivity ({pos}%).",leaderEuText:"{week} ({year}): {virus} shows the highest EU/EEA sentinel positivity ({pos}%).",leadersAria:"Latest virology leaders",virologyTitle:"Sentinel virology",virologyWeek:"Latest: {week}",virologyFilter:"Detections filter",virologyAllViruses:"All viruses",virologyTopDetections:"Top detections",virologyTopPositivity:"Top positivity",virologyNoDetections:"No detections available.",virologyNoPositivity:"No positivity data available.",virologyDetectionsTrend:"Sentinel detections trend",virologyDetectionsSubtitle:"{week} focus",virologyPositivityTrend:"Sentinel positivity trend",euVirologyTitle:"EU/EEA ERVISS virology",euTopDetections:"Top EU detections",euTopPositivity:"Top EU positivity",euNoDetections:"No EU detections available.",euNoPositivity:"No EU positivity data available.",euDetectionsTrend:"EU detections trend",euPositivityTrend:"EU positivity trend",euTrendSubtitle:"Target NH respiratory season: {season}",tableTitle:"Respiratory viruses week-by-week in Hungary",tableNote:"Click Week or Cases to sort; includes matching SARI and positivity context.",tableBadge:"Accessible table view",tableAria:"Weekly table",tableScrollAria:"Scrollable table",tableWeek:"Week",tableVirus:"Virus",tableRegion:"Region",tableCases:"Cases",tableSariAdmissions:"SARI admissions",tableSariIcu:"SARI ICU",tableTopPositivity:"Top positivity",tableNoData:"No data available.",historicalTitle:"Historical season comparison",historicalEmptyHeader:"Select a season that has a prior year available to render comparison trends.",historicalIli:"ILI comparison",historicalSari:"SARI admissions comparison",historicalIcu:"SARI ICU comparison",historicalDelta:"Latest delta: {value}",historicalUnavailable:"Historical comparison is unavailable because the previous season is missing from the loaded data source.",warningsTitle:"Data warnings",footerUpdatedShort:"Updated",footerWarningsShort:"Warn",footerLastUpdateLoading:"Loading data...",noDataShort:"No data",regionNational:"National"},hu:{appTitle:"Szezonális Légúti Kórokozó Dashboard",appSubtitle:"A magyarországi és európai helyzetkép az NNGYK és ECDC adatai alapján",season:"Szezon",language:"Nyelv",theme:"Téma",themeSystem:"Rendszer",themeDark:"Sötét",themeLight:"Világos",sectionCollapse:"Összecsuk",sectionExpand:"Kinyit",sourceTitle:"Adatforrás",sourceLive:"Élő forrás: nngyk_all.json",sourceFallback:"Tartalék forrás: beépített minta",sourceLoading:"betöltés",sectionKicker:"Szekció",sectionHuTitle:"Magyarországi helyzet",sectionHuNote:"NNGYK rutinfelügyeleti és sentinel mutatók a kiválasztott szezonban.",sectionEuTitle:"Európai (EU/EGT) kitekintés",sectionEuNote:"ECDC ERVISS sentinel virológiai mutatók.",alertsAria:"Fő riasztások",signalTitle:"Szezonális influenzaküszöb",signalEpidemicYes:"Influenza járvány van",signalEpidemicNo:"Nincs influenza járvány",signalAbove:"Küszöb felett",signalBelow:"Küszöb alatt",fluTextAbove:"{week}: az ILI-aktivitás ({cases} becsült eset) meghaladja a riasztási küszöböt ({threshold}).",fluTextBelow:"{week}: az ILI-aktivitás ({cases} becsült eset) a riasztási küszöb ({threshold}) alatt marad.",fluChipAbove:"Járványjelzés",fluChipBelow:"Küszöb alatt",alertThreshold:"Riasztási küszöb",crossingLabel:"Küszöbátlépés",alertsLoading:"Adatok betöltése",alertsLoadingPos:"Pozitivitási adatok betöltése",alertsLoadingEuPos:"EU/EGT pozitivitási adatok betöltése",decisionTitle:"Heti helyzetkép",decisionIncreasing:"Az influenzaaktivitás erősödik (HU)",decisionEasing:"Az influenzaaktivitás gyengül",decisionStableHigh:"Az influenzaaktivitás továbbra is magas",decisionRisingBelow:"Az influenzaaktivitás emelkedik",decisionStableLow:"Nincs influenza járványjelzés",decisionConfidence:"Megbízhatóság",decisionFreshness:"Frissítés",decisionEvidenceIli:"ILI és SARI grafikon",decisionEvidenceHuPositivity:"Sentinel pozitivitás",decisionEvidenceEuPositivity:"EU pozitivitás",decisionConfidenceHigh:"Magas",decisionConfidenceMedium:"Közepes",decisionConfidenceLow:"Korlátozott",coverageNngyk:"Lefedettség · NNGYK",coverageNngykNote:"A kiválasztott szezon legfrissebb ILI hete",coverageSari:"Lefedettség · SARI",coverageSariNote:"A kiválasztott szezon legfrissebb SARI hete",coverageErviss:"Lefedettség · ERVISS",coverageErvissNote:"Legfrissebb EU/EGT jelentési hét",coverageMissing:"Hiányzó hetek (ILI/SARI)",coverageMissingNote:"Rések az egyes szezonidősorokban",coverageAria:"Adatlefedettségi jelzők",trendTitle:"Heti trendek",trendNote:"ILI esetszám és sentinel vírus pozitivitások változásai",trendAria:"Heti trendek",trendNoRecentChange:"Nincs friss változás",trendSurging:"Erősödik",trendDeclining:"Gyengül",trendFlat:"Változatlan",trendEmpty:"Nincs friss ILI- vagy pozitivitási trendadat.",rigorTitle:"Epidemiológiai megalapozottság",rigorNote:"Összehasonlítható mutatók: 100 ezer főre vetített ráta, bázis z-score, korcsoporti megoszlás és adatminőségi jelzések.",rigorAria:"Epidemiológiai megalapozottsági mutatók",rigorIliRateCard:"ILI ráta (100 ezer főre)",rigorSariRateCard:"SARI felvételi ráta (100 ezer főre)",rigorWoW:"Heti változás",rigorZScore:"Z-score a bázishoz",rigorBaselineSample:"Bázis szezonok",rigorBaselineMean:"Bázis átlag",rigorAgeSplitTitle:"ILI korcsoporti megoszlás (legfrissebb hét)",rigorAgeMissing:"A korcsoporti megoszlás nem elérhető az aktuális adatforrásban.",rigorAge0to14:"0-14 év",rigorAge15to34:"15-34 év",rigorAge35to59:"35-59 év",rigorAge60plus:"60+ év",rigorQualityTitle:"Bizonytalanság és adatminőség",rigorQualityCoverage:"Lefedettség",rigorQualityBaseline:"Bázis megbízhatóság",rigorQualityAge:"Korcsoporti adat",rigorQualityGood:"Jó",rigorQualityModerate:"Közepes",rigorQualityLimited:"Korlátozott",rigorPer100kSuffix:"/100 ezer",glanceTitle:"Szezon pillanatkép",glanceNote:"Terhelési és növekedési jelzések a szezon alakulásáról.",glanceAria:"Szezon pillanatkép",glanceIli:"Influenzaszerű megbetegedés (ILI)",glanceSari:"SARI felvételek",glanceIcu:"SARI ICU",glancePeak:"Csúcs",glanceLatest:"Legfrissebb",glanceSlope:"3 hetes trend",glanceWow:"Heti változás",glanceWeeksAbove:"Küszöb feletti hetek",glanceStdTitle:"Szezon eddig",glanceStdIli:"ILI kumulatív",glanceStdSari:"SARI kumulatív",glanceSeverityTitle:"Súlyossági arányok",glanceSeveritySari:"SARI az ILI %-ában",glanceSeverityIcu:"ICU a SARI %-ában",stdNoBaseline:"Nincs összehasonlítás",stdMedian:"Medián",stdLastSeason:"Előző szezon",statsTotalIli:"Eheti ILI esetszám",statsPeakIli:"ILI csúcs hét / eset",statsIliVsPrev:"Legfrissebb ILI vs előző szezon",statsIliVsPrevBaseline:"{season}: {value}",statsIliVsPrevNoBaseline:"Ehhez a héthez nincs előző szezonos érték.",statsFirstCrossing:"Első küszöbátlépés",statsWeeksAbove:"Küszöb feletti hetek",statsLatestSari:"Eheti kórházi SARI/ICU",statsAgeSplit:"Eheti ILI korcsoporti megoszlás",chartIli:"Influenzaszerű megbetegedés (ILI)",chartIliSubtitle:"Szezon: {season} (küszöb {threshold})",chartSari:"SARI kórházi felvételek",chartSariSubtitle:"Szezon: {season}",leaderHuTitle:"Legmagasabb sentinel pozitivitás (Magyarország)",leaderEuTitle:"Legmagasabb sentinel pozitivitás (EU/EGT)",leaderHuText:"{week}: {virus} mutatja a legmagasabb sentinel pozitivitást ({pos}%).",leaderEuText:"{week} ({year}): {virus} mutatja a legmagasabb EU/EGT sentinel pozitivitást ({pos}%).",leadersAria:"Legfrissebb virológiai vezetők",virologyTitle:"Sentinel virológia",virologyWeek:"Legfrissebb: {week}",virologyFilter:"Detekció szűrő",virologyAllViruses:"Összes vírus",virologyTopDetections:"Legmagasabb detekciók",virologyTopPositivity:"Legmagasabb pozitivitás",virologyNoDetections:"Nincs detekciós adat.",virologyNoPositivity:"Nincs pozitivitási adat.",virologyDetectionsTrend:"Sentinel detekciós trend",virologyDetectionsSubtitle:"{week} fókusz",virologyPositivityTrend:"Sentinel pozitivitási trend",euVirologyTitle:"EU/EGT ERVISS virológia",euTopDetections:"Legmagasabb EU detekciók",euTopPositivity:"Legmagasabb EU pozitivitás",euNoDetections:"Nincs EU detekciós adat.",euNoPositivity:"Nincs EU pozitivitási adat.",euDetectionsTrend:"EU detekciós trend",euPositivityTrend:"EU pozitivitási trend",euTrendSubtitle:"Cél NH légúti szezon: {season}",tableTitle:"Légúti vírusok heti bontásban (Magyarország)",tableNote:"Kattints a Hét vagy Esetszám oszlopra a rendezéshez; SARI és pozitivitási kontextussal.",tableBadge:"Akadálymentes táblázat",tableAria:"Heti táblázat",tableScrollAria:"Görgethető táblázat",tableWeek:"Hét",tableVirus:"Vírus",tableRegion:"Régió",tableCases:"Esetszám",tableSariAdmissions:"SARI felvételek",tableSariIcu:"SARI intenzív",tableTopPositivity:"Legmagasabb pozitivitás",tableNoData:"Nincs elérhető adat.",historicalTitle:"Történeti szezon összevetés",historicalEmptyHeader:"Válassz olyan szezont, amelyhez elérhető előző év.",historicalIli:"ILI összevetés",historicalSari:"SARI felvételek összevetése",historicalIcu:"SARI ICU összevetés",historicalDelta:"Legfrissebb eltérés: {value}",historicalUnavailable:"A történeti összevetés nem érhető el, mert hiányzik az előző szezon a betöltött adatforrásból.",warningsTitle:"Adat figyelmeztetések",footerUpdatedShort:"Frissítve",footerWarningsShort:"Figy.",footerLastUpdateLoading:"Adatok betöltése...",noDataShort:"Nincs adat",regionNational:"Országos"}};function Pe(i){return String(i??"").toLowerCase().startsWith("hu")?"hu":"en"}function at(i){const t=String(i??"").toLowerCase();return t==="dark"?"dark":t==="light"?"light":"system"}function ot(i){return i==="dark"||i==="light"?i:typeof window>"u"||typeof window.matchMedia!="function"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Z(i,t){return i.replace(/\{(\w+)\}/g,(n,s)=>String(t[s]??""))}function O(i,t="en"){if(typeof i!="number"||!Number.isFinite(i))return"-";const n=String(i).padStart(2,"0");return t==="hu"?`Hét ${n}`:`W${n}`}function lt(i,t){const n=/^W(\d{1,2})$/i.exec(String(i??"").trim());if(!n)return i;const s=String(Number(n[1])).padStart(2,"0");return t==="hu"?`H${s}`:`W${s}`}function cn(i,t){const n=t==="hu"?"hu-HU":"en-US";return new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).format(i)}function un(i){const t=String(i??"").trim().toLowerCase();return t?t===ie.toLowerCase()||t.includes("influenza")||t.includes("flu-like")||t.startsWith("ili")?"influenza":t.includes("sars")||t.includes("cov")?"sarscov2":/\brsv\b/.test(t)?"rsv":t.includes("hmpv")||t.includes("metapneumo")?"hmpv":"other":"other"}function dn(i){return`pathogen-${un(i)}`}function gn(i,t){const n=i+1;return t==="hu"?`${i}/${n}`:`${i}/${n}`}function ni(i,t){return t>=40?i:i+1}function Ue(i){return i>=40?i:i+53}function Y(i,t){return Ue(i)-Ue(t)}function hn(i){return i<=53?i:i-53}function ct(i){const t=Array.from(new Set(i.map(u=>Number(u)).filter(u=>Number.isFinite(u))));if(t.length<2)return[];const n=t.slice().sort(Y),s=Ue(n[0]),l=Ue(n[n.length-1]),a=new Set(t),d=[];for(let u=s;u<=l;u+=1){const h=hn(u);a.has(h)||d.push(h)}return d}function mn(i){if(!i.length)return 0;const t=i.slice().sort((s,l)=>s-l),n=Math.floor(t.length/2);return t.length%2===0?Math.round((t[n-1]+t[n])/2):t[n]}function ri(i,t){return Number.isFinite(t)?i.filter(n=>Number.isFinite(n.week)&&Number.isFinite(n.value)).filter(n=>Y(n.week,t)<=0).reduce((n,s)=>n+s.value,0):null}function ai(i){const t=i.filter(u=>Number.isFinite(u.week)&&Number.isFinite(u.value)).slice().sort((u,h)=>Y(u.week,h.week));if(!t.length)return null;const n=t.reduce((u,h)=>h.value>u.value?h:u,t[0]),s=t[t.length-1],l=t.slice(Math.max(0,t.length-3)),a=l.length>=2?(l[l.length-1].value-l[0].value)/(l.length-1):null,d=n.value>0?s.value/n.value*100:null;return{peak:n,latest:s,pctOfPeak:d,slope:a}}function Be(i){const t=i.filter(l=>Number.isFinite(l.week)&&Number.isFinite(l.value)).slice().sort((l,a)=>Y(l.week,a.week));if(t.length<2)return null;const n=t[t.length-1].value,s=t[t.length-2].value;return!Number.isFinite(n)||!Number.isFinite(s)||s<=0?null:(n-s)/s*100}function ut(i,t,n,s){if(!Number.isFinite(n))return{currentTotal:null,baselineCount:0,median:null,lastSeason:null,percentile:null};const l=i(t),a=ri(l,Number(n));if(typeof a!="number"||!Number.isFinite(a))return{currentTotal:null,baselineCount:0,median:null,lastSeason:null,percentile:null};const d=s.filter(f=>f<t).sort((f,p)=>f-p),u=d.map(f=>ri(i(f),Number(n))).filter(f=>typeof f=="number"&&Number.isFinite(f)&&f>0),h=d.length?d[d.length-1]:null,g=h==null?null:(()=>{const f=ri(i(h),Number(n));return Number.isFinite(f)?f:null})(),b=u.length>=2?mn(u):null,T=u.length>=2?Math.round(u.filter(f=>f<=a).length/u.length*100):null;return{currentTotal:a,baselineCount:u.length,median:b,lastSeason:g,percentile:T}}function dt(i,t){if(!Number.isFinite(i.currentTotal))return"–";const n=Number(i.currentTotal).toLocaleString();if(!i.baselineCount)return`${n} (${t.noBaseline})`;const s=[];return i.baselineCount>=2&&Number.isFinite(i.median)?s.push(`${t.median} ${Number(i.median).toLocaleString()}`):Number.isFinite(i.lastSeason)&&s.push(`${t.lastSeason} ${Number(i.lastSeason).toLocaleString()}`),i.percentile!=null&&s.push(`P${i.percentile}`),s.length?`${n} (${s.join(", ")})`:n}function pn(i,t){if(!i.length||!t.length)return null;const n=new Map(i.map(g=>[g.week,g.value])),s=t.map(g=>g.week).filter(g=>Number.isFinite(g)&&n.has(g)).sort((g,b)=>Y(g,b));if(!s.length)return null;const l=s[s.length-1],a=Number(n.get(l)??0),d=t.find(g=>g.week===l),u=Number((d==null?void 0:d.admissions)??0),h=Number((d==null?void 0:d.icu)??0);return!Number.isFinite(a)||a<=0||!Number.isFinite(u)||u<=0?null:{week:l,sariPercent:u/a*100,icuShare:Number.isFinite(h)&&u>0?h/u*100:null}}function oi(i,t){return i?`${O(i.week,t)}: ${Number(i.value).toLocaleString()}`:"–"}function li(i,t){if(!i)return"–";const n=`${O(i.latest.week,t)}: ${Number(i.latest.value).toLocaleString()}`;return Number.isFinite(i.pctOfPeak)?`${n} (${Math.round(Number(i.pctOfPeak))}%)`:n}function ci(i,t){if(!Number.isFinite(i))return"–";const n=Math.round(Number(i)),s=n>0?"+":"";return t==="hu"?`${s}${n.toLocaleString()}/hét`:`${s}${n.toLocaleString()}/week`}function ui(i){if(!Number.isFinite(i))return"0%";const t=Math.round(i);return`${t>0?"+":""}${t}%`}function It(i,t=on){return!Number.isFinite(i)||!Number.isFinite(t)||t<=0?null:Number(i)/t*1e5}function gt(i){if(!i.length)return null;const t=Array.from(new Set(i.map(a=>a.week))).sort((a,d)=>Y(a,d));if(!t.length)return null;const n=t[0],s=t[t.length-1],l=Y(s,n)+1;return!Number.isFinite(l)||l<=0?null:Math.min(1,t.length/l)}function fn(i,t,n,s,l){if(!Number.isFinite(i)||!Number.isFinite(t))return{zScore:null,baselineCount:0,baselineMean:null};const a=s.filter(g=>g<n).map(g=>{var b;return((b=l(g).find(T=>T.week===t))==null?void 0:b.value)??null}).filter(g=>Number.isFinite(g));if(!a.length)return{zScore:null,baselineCount:0,baselineMean:null};const d=a.reduce((g,b)=>g+b,0)/a.length;if(a.length<2)return{zScore:null,baselineCount:a.length,baselineMean:d};const u=a.reduce((g,b)=>g+(b-d)*(b-d),0)/a.length,h=Math.sqrt(u);return!Number.isFinite(h)||h===0?{zScore:Math.abs(Number(i)-d)<1e-9?0:null,baselineCount:a.length,baselineMean:d}:{zScore:(Number(i)-d)/h,baselineCount:a.length,baselineMean:d}}function ht(i,t,n,s){const l=i.filter(h=>Number.isFinite(h.week)&&Number.isFinite(h.value)).slice().sort((h,g)=>Y(h.week,g.week)),a=l.length?l[l.length-1]:null,d=Be(l),u=fn((a==null?void 0:a.value)??null,(a==null?void 0:a.week)??null,t,n,s);return{latestWeek:(a==null?void 0:a.week)??null,latestValue:(a==null?void 0:a.value)??null,ratePer100k:a?It(a.value):null,weekOverWeekPercent:d,baseline:u}}function di(i,t){return Number.isFinite(i)?`${Number(i).toLocaleString(void 0,{minimumFractionDigits:1,maximumFractionDigits:1})} ${t}`:"–"}function mt(i){if(!Number.isFinite(i))return"–";const t=Math.round(Number(i)*100)/100;return`${t>0?"+":""}${t.toFixed(2)}`}function bn(i){return i>=70?"high":i>=45?"medium":"low"}function ue(i){return dn(i)}function pt({virus:i}){const t=ue(i);return e.jsx("span",{className:`virus-icon ${t}`,"aria-hidden":"true",children:e.jsxs("svg",{viewBox:"0 0 24 24",focusable:"false",children:[e.jsx("circle",{cx:"12",cy:"12",r:"4.5"}),e.jsx("line",{x1:"12",y1:"2.5",x2:"12",y2:"5.8"}),e.jsx("line",{x1:"12",y1:"18.2",x2:"12",y2:"21.5"}),e.jsx("line",{x1:"2.5",y1:"12",x2:"5.8",y2:"12"}),e.jsx("line",{x1:"18.2",y1:"12",x2:"21.5",y2:"12"}),e.jsx("line",{x1:"5.3",y1:"5.3",x2:"7.8",y2:"7.8"}),e.jsx("line",{x1:"16.2",y1:"16.2",x2:"18.7",y2:"18.7"}),e.jsx("line",{x1:"18.7",y1:"5.3",x2:"16.2",y2:"7.8"}),e.jsx("line",{x1:"7.8",y1:"16.2",x2:"5.3",y2:"18.7"})]})})}function vn(i=820){const t=`(max-width: ${i}px)`,[n,s]=N.useState(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia(t).matches);return N.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia!="function")return;const l=window.matchMedia(t),a=d=>s(d.matches);return s(l.matches),l.addEventListener("change",a),()=>l.removeEventListener("change",a)},[t]),n}function yn(){var Fi,Ri,Di,Vi,Mi,Pi;const i=vn(),[t,n]=N.useState(()=>He()),[s,l]=N.useState(()=>{if(typeof window>"u")return"en";const o=new URL(window.location.href).searchParams.get("lang");if(o)return Pe(o);const v=window.localStorage.getItem(nt);return Pe(v||window.navigator.language)}),[a,d]=N.useState(()=>typeof window>"u"?"system":at(window.localStorage.getItem(rt))),[u,h]=N.useState(()=>ot("system")),[g,b]=N.useState(void 0),[T,f]=N.useState(ke),[p,$]=N.useState("week"),[m,S]=N.useState("asc"),[y,x]=N.useState(!0),[E,C]=N.useState(null),[F,D]=N.useState(!0),[V,B]=N.useState(!0),[q,ae]=N.useState(!0),[ge,Se]=N.useState(!0),[Le,ki]=N.useState(!0),r=ln[s],R=u==="dark";N.useEffect(()=>{if(typeof window>"u")return;document.documentElement.lang=s,window.localStorage.setItem(nt,s);const o=new URL(window.location.href);o.searchParams.set("lang",s),window.history.replaceState({},"",`${o.pathname}${o.search}${o.hash}`)},[s]),N.useEffect(()=>{if(typeof window>"u")return;window.localStorage.setItem(rt,a);const o=()=>{const k=ot(a);h(k),document.documentElement.setAttribute("data-theme",k)};if(o(),a!=="system"||typeof window.matchMedia!="function")return;const v=window.matchMedia("(prefers-color-scheme: dark)"),I=()=>o();return v.addEventListener("change",I),()=>v.removeEventListener("change",I)},[a]),N.useEffect(()=>{let o=!0;return(async()=>{try{const v=await Zs();if(!o)return;n(v)}catch{if(!o)return;n(He("Runtime loading failed; using bundled sample."))}finally{o&&(x(!1),C(new Date))}})(),()=>{o=!1}},[]);const c=N.useMemo(()=>Hs(t,g),[t,g]);N.useEffect(()=>{(g==null||!c.availableYears.includes(g))&&b(c.selectedYear)},[g,c.availableYears,c.selectedYear]),N.useEffect(()=>{T!==ke&&!c.virology.availableDetectionViruses.includes(T)&&f(ke)},[T,c.virology.availableDetectionViruses]);const zt=N.useMemo(()=>en({points:c.iliSeries,threshold:c.iliThreshold,compact:i,dark:R,labels:{iliCases:r.glanceIli,alertThreshold:r.alertThreshold,crossing:r.crossingLabel,noData:r.noDataShort,seasonStart:s==="hu"?"Szezonkezdet":"Season start",holidays:s==="hu"?"Ünnepi időszak":"Holiday period",weekPrefix:s==="hu"?"H":"W"}}),[i,R,s,c.iliSeries,c.iliThreshold,r.alertThreshold,r.crossingLabel,r.glanceIli,r.noDataShort]),At=N.useMemo(()=>{const o=c.sariSeries.length>0,v=o?c.sariSeries[c.sariSeries.length-1].label:null,I=c.sariSeries.map(j=>j.admissions),k=c.sariSeries.map(j=>j.icu),L=R?{axisLabel:"#cbd5e1",axisLine:"rgba(148, 163, 184, 0.45)",grid:"rgba(148, 163, 184, 0.16)",legend:"#e2e8f0",legendBg:"rgba(15, 23, 42, 0.82)",legendBorder:"rgba(148, 163, 184, 0.32)",currentWeekLine:"rgba(125, 211, 252, 0.55)",tooltipBg:"rgba(15, 23, 42, 0.96)",tooltipBorder:"rgba(148, 163, 184, 0.48)",tooltipText:"#e2e8f0"}:{axisLabel:"#334155",axisLine:"rgba(15, 23, 42, 0.20)",grid:"rgba(15, 23, 42, 0.1)",legend:"#0f172a",legendBg:"rgba(248, 250, 252, 0.92)",legendBorder:"rgba(148, 163, 184, 0.38)",currentWeekLine:"rgba(37, 99, 235, 0.45)",tooltipBg:"rgba(15, 23, 42, 0.94)",tooltipBorder:"rgba(30, 41, 59, 0.24)",tooltipText:"#f8fafc"};return{animation:!1,grid:{top:i?40:78,right:18,bottom:34,left:54},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:L.currentWeekLine,type:"dashed",width:1.1}},backgroundColor:L.tooltipBg,borderColor:L.tooltipBorder,borderWidth:1,textStyle:{color:L.tooltipText,fontWeight:600},extraCssText:"box-shadow: 0 14px 30px rgba(2, 6, 23, 0.28);",formatter:j=>{const M=Array.isArray(j)?j:[];if(!M.length)return"";const _=M[0],w=lt(_.axisValueLabel??"",s),z=M.map(G=>{const W=G,P=typeof W.data=="number"&&Number.isFinite(W.data)?W.data.toLocaleString():"–";return`${W.marker??""} ${W.seriesName??""}: ${P}`}).join("<br/>");return`${w}<br/>${z}`}},legend:{show:!i,top:2,left:8,right:8,itemWidth:12,itemHeight:8,itemGap:12,padding:[6,10],backgroundColor:L.legendBg,borderColor:L.legendBorder,borderWidth:1,borderRadius:10,textStyle:{color:L.legend,fontWeight:600,fontSize:12,lineHeight:16},icon:"circle"},xAxis:{type:"category",data:c.sariSeries.map(j=>j.label),boundaryGap:!1,axisLine:{lineStyle:{color:L.axisLine}},axisTick:{show:!1},axisLabel:{color:L.axisLabel,hideOverlap:!0,formatter:j=>lt(String(j),s)}},yAxis:{type:"value",min:0,axisLabel:{color:L.axisLabel,formatter:j=>j.toLocaleString()},splitLine:{lineStyle:{color:L.grid,type:[4,5]}}},series:[{name:r.tableSariAdmissions,type:"line",data:o?I:[0],smooth:.22,showSymbol:!1,symbol:"circle",symbolSize:6,lineStyle:{width:2.8,color:R?"#7dd3fc":"#2563eb",cap:"round"},itemStyle:{color:R?"#7dd3fc":"#2563eb"},areaStyle:{color:new gi(0,0,0,1,[{offset:0,color:R?"rgba(125, 211, 252, 0.34)":"rgba(59, 130, 246, 0.22)"},{offset:1,color:R?"rgba(56, 189, 248, 0.05)":"rgba(147, 197, 253, 0.03)"}])},emphasis:{focus:"series",lineStyle:{width:3.4}},markLine:v?{symbol:["none","none"],silent:!0,lineStyle:{color:L.currentWeekLine,width:1.3,type:"dashed"},label:{show:!1},data:[{xAxis:v}]}:void 0,z:4},{name:r.tableSariIcu,type:"line",data:o?k:[0],smooth:.2,showSymbol:!1,symbol:"circle",symbolSize:6,lineStyle:{width:2.4,color:R?"#fb923c":"#dc2626",cap:"round"},itemStyle:{color:R?"#fb923c":"#dc2626"},areaStyle:{color:new gi(0,0,0,1,[{offset:0,color:R?"rgba(251, 146, 60, 0.24)":"rgba(248, 113, 113, 0.18)"},{offset:1,color:R?"rgba(249, 115, 22, 0.04)":"rgba(252, 165, 165, 0.03)"}])},emphasis:{focus:"series",lineStyle:{width:3}},z:5}]}},[i,R,s,c.sariSeries,r.tableSariAdmissions,r.tableSariIcu]),Tt=N.useMemo(()=>tt({rows:c.virology.detectionRows,selectedVirus:T,compact:i,language:s,dark:R}),[i,R,s,T,c.virology.detectionRows]),Ct=N.useMemo(()=>st({rows:c.virology.positivityRows,compact:i,language:s,dark:R}),[i,R,s,c.virology.positivityRows]),$t=N.useMemo(()=>tt({rows:c.euVirology.detectionRows,selectedVirus:ke,compact:i,weekOrder:"season",language:s,dark:R}),[i,R,s,c.euVirology.detectionRows]),Et=N.useMemo(()=>st({rows:c.euVirology.positivityRows,compact:i,weekOrder:"season",language:s,dark:R}),[i,R,s,c.euVirology.positivityRows]),Si=N.useMemo(()=>{if(c.virology.latestWeek==null)return[];const o=c.virology.detectionRows.filter(k=>k.week===c.virology.latestWeek).filter(k=>T===ke||k.virus===T).slice().sort((k,L)=>L.detections-k.detections),v=o.find(k=>k.virus===ie);return[...v?[v]:[],...o.filter(k=>k.virus!==ie)].slice(0,6)},[T,c.virology.detectionRows,c.virology.latestWeek]),xi=N.useMemo(()=>c.virology.latestWeek==null?[]:c.virology.positivityRows.filter(o=>o.week===c.virology.latestWeek).slice().sort((o,v)=>v.positivity-o.positivity).slice(0,6),[c.virology.latestWeek,c.virology.positivityRows]),Ni=N.useMemo(()=>c.euVirology.latestWeek==null?[]:c.euVirology.detectionRows.filter(o=>o.week===c.euVirology.latestWeek).slice().sort((o,v)=>v.detections-o.detections).slice(0,6),[c.euVirology.detectionRows,c.euVirology.latestWeek]),wi=N.useMemo(()=>c.euVirology.latestWeek==null?[]:c.euVirology.positivityRows.filter(o=>o.week===c.euVirology.latestWeek).slice().sort((o,v)=>v.positivity-o.positivity).slice(0,6),[c.euVirology.latestWeek,c.euVirology.positivityRows]),Li=N.useMemo(()=>!c.historical.available||!c.historical.compareSeasonLabel?null:si({metric:c.historical.ili,compareSeasonLabel:c.historical.compareSeasonLabel,currentSeasonLabel:c.historical.currentSeasonLabel,compact:i,dark:R,language:s,labels:{noData:r.noDataShort}}),[i,R,s,c.historical,r.noDataShort]),ji=N.useMemo(()=>!c.historical.available||!c.historical.compareSeasonLabel?null:si({metric:c.historical.sariAdmissions,compareSeasonLabel:c.historical.compareSeasonLabel,currentSeasonLabel:c.historical.currentSeasonLabel,compact:i,dark:R,language:s,labels:{noData:r.noDataShort}}),[i,R,s,c.historical,r.noDataShort]),Ii=N.useMemo(()=>!c.historical.available||!c.historical.compareSeasonLabel?null:si({metric:c.historical.sariIcu,compareSeasonLabel:c.historical.compareSeasonLabel,currentSeasonLabel:c.historical.currentSeasonLabel,compact:i,dark:R,language:s,labels:{noData:r.noDataShort}}),[i,R,s,c.historical,r.noDataShort]),ne=N.useMemo(()=>{if(!c.virology.positivityRows.length)return null;const o=c.virology.positivityRows.reduce((k,L)=>Y(L.week,k)>0?L.week:k,c.virology.positivityRows[0].week),v=c.virology.positivityRows.filter(k=>k.week===o);if(!v.length)return null;const I=v.reduce((k,L)=>L.positivity>k.positivity?L:k,v[0]);return{week:o,virus:I.virus,positivity:I.positivity}},[c.virology.positivityRows]),te=N.useMemo(()=>{if(c.euVirology.targetYear==null||!c.euVirology.positivityRows.length)return null;const o=c.euVirology.positivityRows.reduce((k,L)=>Y(L.week,k)>0?L.week:k,c.euVirology.positivityRows[0].week),v=c.euVirology.positivityRows.filter(k=>k.week===o);if(!v.length)return null;const I=v.reduce((k,L)=>L.positivity>k.positivity?L:k,v[0]);return{year:ni(c.euVirology.targetYear,o),week:o,virus:I.virus,positivity:I.positivity}},[c.euVirology.positivityRows,c.euVirology.targetYear]),Wt=c.iliSeries.length?O(c.iliSeries[c.iliSeries.length-1].week,s):"–",zi=c.sariSeries.length?O(c.sariSeries[c.sariSeries.length-1].week,s):"–",Ye=N.useMemo(()=>ct(c.iliSeries.map(o=>o.week)),[c.iliSeries]),_e=N.useMemo(()=>ct(c.sariSeries.map(o=>o.week)),[c.sariSeries]),H=N.useMemo(()=>{const o=c.iliSeries.map(z=>({week:z.week,value:z.cases})),v=c.sariSeries.map(z=>({week:z.week,value:z.admissions})),I=c.sariSeries.map(z=>({week:z.week,value:z.icu})),k=ai(o),L=ai(v),j=ai(I),M=z=>{const G=new Map;for(const W of t.respiratoryData.weekly){const P=Number(W.year);if(!Number.isFinite(P)||P!==z||(W.dataset??Me)!==Me||(W.virus??ye)!==ye)continue;const be=Number(W.week);if(!Number.isFinite(be))continue;const Ie=Number(W.cases??0);Number.isFinite(Ie)&&G.set(be,(G.get(be)??0)+Ie)}return Array.from(G.entries()).sort((W,P)=>Y(W[0],P[0])).map(([W,P])=>({week:W,value:P}))},_=z=>{const G=new Map;for(const W of t.respiratoryData.sariWeekly){const P=Number(W.year);if(!Number.isFinite(P)||P!==z)continue;const re=Number(W.week);if(!Number.isFinite(re))continue;const fe=Number(W.admissions??0);Number.isFinite(fe)&&G.set(re,(G.get(re)??0)+fe)}return Array.from(G.entries()).sort((W,P)=>Y(W[0],P[0])).map(([W,P])=>({week:W,value:P}))},w=pn(o,c.sariSeries.map(z=>({week:z.week,admissions:z.admissions,icu:z.icu})));return{iliGlance:k,sariGlance:L,icuGlance:j,iliWow:Be(o),sariWow:Be(v),icuWow:Be(I),weeksAboveThreshold:o.filter(z=>z.value>=c.iliThreshold).length,iliSeasonToDate:ut(M,c.selectedYear,(k==null?void 0:k.latest.week)??null,c.availableYears),sariSeasonToDate:ut(_,c.selectedYear,(L==null?void 0:L.latest.week)??null,c.availableYears),severity:w}},[t.respiratoryData.sariWeekly,t.respiratoryData.weekly,c.availableYears,c.iliSeries,c.iliThreshold,c.sariSeries,c.selectedYear]),A=N.useMemo(()=>{const o=oe=>{const le=new Map;for(const K of t.respiratoryData.weekly){const se=Number(K.year);if(!Number.isFinite(se)||se!==oe||(K.dataset??Me)!==Me||(K.virus??ye)!==ye)continue;const ii=Number(K.week);if(!Number.isFinite(ii))continue;const Bi=Number(K.cases??0);Number.isFinite(Bi)&&le.set(ii,(le.get(ii)??0)+Bi)}return Array.from(le.entries()).sort((K,se)=>Y(K[0],se[0])).map(([K,se])=>({week:K,value:se}))},v=oe=>{const le=new Map;for(const K of t.respiratoryData.sariWeekly){const se=Number(K.year);if(!Number.isFinite(se)||se!==oe)continue;const Re=Number(K.week);if(!Number.isFinite(Re))continue;const ei=Number(K.admissions??0);Number.isFinite(ei)&&le.set(Re,(le.get(Re)??0)+ei)}return Array.from(le.entries()).sort((K,se)=>Y(K[0],se[0])).map(([K,se])=>({week:K,value:se}))},I=o(c.selectedYear),k=v(c.selectedYear),L=ht(I,c.selectedYear,c.availableYears,o),j=ht(k,c.selectedYear,c.availableYears,v),M=t.iliAgeSplits.filter(oe=>oe.year===c.selectedYear).slice().sort((oe,le)=>Y(oe.week,le.week)),_=L.latestWeek,w=M.find(oe=>oe.week===_)??(M.length?M[M.length-1]:null),z=gt(I),G=gt(k),W=z!=null&&G!=null?(z+G)/2:z??G,P=Math.min(L.baseline.baselineCount,j.baseline.baselineCount),re=w!=null,fe=W==null?"limited":W>=.9?"good":W>=.75?"moderate":"limited",be=P>=5?"good":P>=3?"moderate":"limited";return{iliMetric:L,sariMetric:j,ageSplit:w,quality:{coverageRatio:W,baselineCount:P,ageSplitAvailable:re,coverageLevel:fe,baselineLevel:be,ageLevel:re?"good":"limited"}}},[t.iliAgeSplits,t.respiratoryData.sariWeekly,t.respiratoryData.weekly,c.availableYears,c.selectedYear]),Q=N.useMemo(()=>{const o=c.iliSeries.length?c.iliSeries[c.iliSeries.length-1]:null;if(!o)return null;const v=c.historical.ili.points.find(j=>j.week===o.week)??null,I=v&&typeof v.previous=="number"&&Number.isFinite(v.previous)?v.previous:null,k=I!=null&&I!==0?(o.cases-I)/I*100:null,L=k==null?"flat":k>0?"surging":k<0?"declining":"flat";return{week:o.week,currentCases:o.cases,previousCases:I,deltaPercent:k,direction:L}},[c.historical.ili.points,c.iliSeries]),Oe=N.useMemo(()=>{const o=[],v=c.iliSeries.map(w=>({week:w.week,value:w.cases})).filter(w=>Number.isFinite(w.week)&&Number.isFinite(w.value)).sort((w,z)=>Y(w.week,z.week)),I=v[v.length-1],k=v[v.length-2];if(I&&k){const w=k.value>0?(I.value-k.value)/k.value*100:0,z=w>0?"surging":w<0?"declining":"flat";o.push({virus:ye,label:ui(w),change:w,week:I.week,direction:z})}const L=c.virology.positivityRows.filter(w=>w.virus!==ie).filter(w=>Number.isFinite(w.week)&&Number.isFinite(w.positivity));if(!L.length)return o;const j=L.reduce((w,z)=>Y(z.week,w)>0?z.week:w,L[0].week),M=L.filter(w=>w.week===j).slice().sort((w,z)=>z.positivity-w.positivity).map(w=>w.virus),_=new Map;for(const w of L){const z=_.get(w.virus)??[];z.push({week:w.week,positivity:w.positivity}),_.set(w.virus,z)}for(const w of M){if(o.length>=4)break;const z=_.get(w);if(!z||z.length<2)continue;const G=z.slice().sort((be,Ie)=>Y(be.week,Ie.week)),W=G[G.length-1],P=G[G.length-2];if(!W||!P)continue;const re=P.positivity>0?(W.positivity-P.positivity)/P.positivity*100:0,fe=re>0?"surging":re<0?"declining":"flat";o.push({virus:w,label:ui(re),change:re,week:W.week,direction:fe})}return o.slice(0,4)},[c.iliSeries,c.virology.positivityRows]),Ge=N.useMemo(()=>{const o=new Map;for(const v of c.virology.positivityRows){const I=o.get(v.week);(!I||v.positivity>I.positivity)&&o.set(v.week,{virus:v.virus,positivity:v.positivity})}return o},[c.virology.positivityRows]),Ai=N.useMemo(()=>{const o=new Map(c.iliSeries.map(j=>[j.week,j.cases])),v=new Map(c.sariSeries.map(j=>[j.week,{admissions:j.admissions,icu:j.icu}])),I=new Set;for(const j of o.keys())I.add(j);for(const j of v.keys())I.add(j);for(const j of Ge.keys())I.add(j);for(const j of c.virology.detectionRows)I.add(j.week);const k=Array.from(I).map(j=>{const M=v.get(j),_=Ge.get(j);return{week:j,virus:ye,region:"National",cases:o.get(j)??null,sariAdmissions:(M==null?void 0:M.admissions)??null,sariIcu:(M==null?void 0:M.icu)??null,topPositivityVirus:(_==null?void 0:_.virus)??null,topPositivity:(_==null?void 0:_.positivity)??null}}),L=m==="asc"?1:-1;return k.sort((j,M)=>{if(p==="week"){const w=Y(j.week,M.week);if(w!==0)return w*L}else{const w=Number(j.cases??0)-Number(M.cases??0);if(w!==0)return w*L}const _=Y(j.week,M.week);return _!==0?_:j.virus.localeCompare(M.virus)})},[c.iliSeries,c.sariSeries,c.virology.detectionRows,p,m,Ge]),Ft=p==="week"?m==="asc"?"ascending":"descending":"none",Rt=p==="cases"?m==="asc"?"ascending":"descending":"none",Dt=p==="week"?m==="asc"?"▲":"▼":"",Vt=p==="cases"?m==="asc"?"▲":"▼":"",Ee=o=>{if(p===o){S(v=>v==="asc"?"desc":"asc");return}$(o),S("asc")},je=c.stats.latestIliCases>=c.iliThreshold,Mt=je?"critical":"ok",Pt=je?r.signalEpidemicYes:r.signalEpidemicNo,Bt=Z(je?r.fluTextAbove:r.fluTextBelow,{week:O(c.stats.latestWeek,s),cases:c.stats.latestIliCases.toLocaleString(),threshold:c.iliThreshold.toLocaleString()}),Ke=Oe.find(o=>o.virus===ye)??null,Ht=(()=>{const o=Ke==null?void 0:Ke.change;return je?o!=null&&o>=8?r.decisionIncreasing:o!=null&&o<=-8?r.decisionEasing:r.decisionStableHigh:o!=null&&o>=12?r.decisionRisingBelow:r.decisionStableLow})(),qe=o=>o==="high"?r.decisionConfidenceHigh:o==="medium"?r.decisionConfidenceMedium:r.decisionConfidenceLow,Qe=({hasData:o,missingWeeks:v,warningCount:I})=>{let k=100;return y&&(k-=28),o||(k-=30),k-=Math.min(26,v*6),k-=Math.min(24,I*8),bn(k)},Ti=Ye.length+_e.length,Ci=Qe({hasData:c.iliSeries.length>1,missingWeeks:Ti,warningCount:c.warnings.length}),$i=Qe({hasData:ne!=null&&c.virology.latestWeek!=null,missingWeeks:Math.ceil(Ti/2),warningCount:c.warnings.length}),Ei=Qe({hasData:te!=null&&c.euVirology.latestWeek!=null,missingWeeks:0,warningCount:c.warnings.length}),Ut=qe(Ci),Yt=qe($i),_t=qe(Ei),We=(o,v=0)=>{if(typeof window>"u")return;const I=document.getElementById(o);if(I){I.scrollIntoView({behavior:"smooth",block:"start"});return}v>=10||window.setTimeout(()=>We(o,v+1),80)},Ze=o=>{if(o==="hu-ili-sari-charts"){Se(!0),We(o);return}if(o==="hu-sentinel-positivity"){Se(!0),D(!0),We(o);return}ki(!0),We(o)},Ot=t.source==="nngyk_all"?"live":"sample",Gt=t.source==="nngyk_all"?r.sourceLive:r.sourceFallback,Fe=c.virology.latestWeek==null?"–":O(c.virology.latestWeek,s),Wi=c.euVirology.targetYear==null?"–":gn(c.euVirology.targetYear,s),Je=c.euVirology.targetYear!=null&&c.euVirology.latestWeek!=null?s==="hu"?`${ni(c.euVirology.targetYear,c.euVirology.latestWeek)} · ${O(c.euVirology.latestWeek,s)}`:`${ni(c.euVirology.targetYear,c.euVirology.latestWeek)}-${O(c.euVirology.latestWeek,s)}`:"–",Kt=ne?Z(r.leaderHuText,{week:O(ne.week,s),virus:J(ne.virus,s),pos:ne.positivity.toFixed(1)}):r.alertsLoadingPos,qt=ne?J(ne.virus,s):r.noDataShort,Qt=ue(ne==null?void 0:ne.virus),Zt=te?Z(r.leaderEuText,{week:O(te.week,s),year:te.year,virus:J(te.virus,s),pos:te.positivity.toFixed(1)}):r.alertsLoadingEuPos,Jt=te?J(te.virus,s):r.noDataShort,Xt=ue(te==null?void 0:te.virus),Xe=o=>o==="good"?r.rigorQualityGood:o==="moderate"?r.rigorQualityModerate:r.rigorQualityLimited,pe=o=>o==="good"?"ok":"warn",es=A.quality.coverageRatio==null?"–":`${Math.round(A.quality.coverageRatio*100).toLocaleString()}%`,is=A.iliMetric.baseline.baselineCount>0?A.iliMetric.baseline.baselineCount.toLocaleString():"–",ts=y?r.footerLastUpdateLoading:E?cn(E,s):r.noDataShort,ss=`${r.footerUpdatedShort}: ${ts}`,ns=`${r.footerWarningsShort}: ${c.warnings.length.toLocaleString()}`,rs=c.warnings.length?`${r.warningsTitle}: ${c.warnings.join(" · ")}`:void 0;return e.jsxs("div",{className:`app-shell theme-${u}`,children:[e.jsxs("header",{className:"topbar",children:[e.jsxs("div",{className:"topbar-brand",children:[e.jsx("img",{className:"topbar-logo",src:"./virusicon.jpeg",alt:"","aria-hidden":"true"}),e.jsxs("div",{className:"topbar-copy",children:[e.jsx("h1",{children:r.appTitle}),e.jsx("p",{className:"subtitle",children:r.appSubtitle})]})]}),e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"year-select",children:r.season}),e.jsx("select",{id:"year-select",value:c.selectedYear,onChange:o=>b(Number(o.target.value)),children:c.availableYears.map(o=>e.jsxs("option",{value:o,children:[o,"-",o+1]},o))})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"lang-select",children:r.language}),e.jsxs("select",{id:"lang-select",value:s,onChange:o=>l(Pe(o.target.value)),children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"hu",children:"Magyar"})]})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"theme-select",children:r.theme}),e.jsxs("select",{id:"theme-select",value:a,onChange:o=>d(at(o.target.value)),children:[e.jsx("option",{value:"system",children:r.themeSystem}),e.jsx("option",{value:"dark",children:r.themeDark}),e.jsx("option",{value:"light",children:r.themeLight})]})]})]})]}),e.jsxs("section",{className:"alerts-grid","aria-label":r.alertsAria,children:[e.jsxs("article",{className:`alert-card primary epidemic ${Mt}`,role:"status","aria-live":"polite",children:[e.jsx("span",{className:"alert-kicker",children:r.decisionTitle}),e.jsxs("h2",{children:[je?e.jsx("span",{className:"alert-status-icon","aria-hidden":"true",children:"!"}):null,e.jsx("span",{children:Ht})]}),e.jsx("p",{className:"alert-standfirst",children:Pt}),e.jsx("p",{children:Bt}),e.jsxs("div",{className:"alert-meta",children:[e.jsxs("span",{className:`alert-meta-chip confidence-${Ci}`,children:[r.decisionConfidence,": ",Ut]}),e.jsxs("span",{className:"alert-meta-chip",children:[r.decisionFreshness,": ",O(c.stats.latestWeek,s)]})]}),e.jsx("button",{type:"button",className:"alert-evidence-btn",onClick:()=>Ze("hu-ili-sari-charts"),children:r.decisionEvidenceIli})]}),e.jsxs("article",{className:`alert-card leader summary ${Qt}`,role:"status","aria-live":"polite",children:[e.jsx("h2",{children:r.leaderHuTitle}),e.jsxs("div",{className:"alert-emphasis-row",children:[ne?e.jsx(pt,{virus:ne.virus}):null,e.jsx("strong",{className:"alert-emphasis",children:qt})]}),e.jsx("p",{children:Kt}),e.jsxs("div",{className:"alert-meta",children:[e.jsxs("span",{className:`alert-meta-chip confidence-${$i}`,children:[r.decisionConfidence,": ",Yt]}),e.jsxs("span",{className:"alert-meta-chip",children:[r.decisionFreshness,": ",Fe]})]}),e.jsx("button",{type:"button",className:"alert-evidence-btn",onClick:()=>Ze("hu-sentinel-positivity"),children:r.decisionEvidenceHuPositivity})]}),e.jsxs("article",{className:`alert-card leader summary ${Xt}`,role:"status","aria-live":"polite",children:[e.jsx("h2",{children:r.leaderEuTitle}),e.jsxs("div",{className:"alert-emphasis-row",children:[te?e.jsx(pt,{virus:te.virus}):null,e.jsx("strong",{className:"alert-emphasis",children:Jt})]}),e.jsx("p",{children:Zt}),e.jsxs("div",{className:"alert-meta",children:[e.jsxs("span",{className:`alert-meta-chip confidence-${Ei}`,children:[r.decisionConfidence,": ",_t]}),e.jsxs("span",{className:"alert-meta-chip",children:[r.decisionFreshness,": ",Je]})]}),e.jsx("button",{type:"button",className:"alert-evidence-btn",onClick:()=>Ze("eu-positivity-chart"),children:r.decisionEvidenceEuPositivity})]})]}),e.jsxs("section",{className:"region-block hu-block","aria-label":r.sectionHuTitle,children:[e.jsxs("section",{className:"region-divider hu","aria-label":r.sectionHuTitle,children:[e.jsxs("div",{className:"region-divider-main",children:[e.jsx("span",{className:"region-divider-kicker",children:r.sectionKicker}),e.jsxs("div",{children:[e.jsx("h2",{children:r.sectionHuTitle}),e.jsx("p",{children:r.sectionHuNote})]})]}),e.jsxs("button",{type:"button",className:"section-toggle region-toggle","aria-expanded":ge,"aria-controls":"hu-region-content","aria-label":`${ge?r.sectionCollapse:r.sectionExpand}: ${r.sectionHuTitle}`,onClick:()=>Se(o=>!o),children:[e.jsx("span",{className:`section-toggle-icon ${ge?"open":""}`,"aria-hidden":"true",children:"▾"}),e.jsx("span",{children:ge?r.sectionCollapse:r.sectionExpand})]})]}),ge?e.jsxs("div",{id:"hu-region-content",className:"region-content",children:[e.jsxs("section",{className:"briefing-grid",children:[e.jsxs("section",{className:"surge-section","aria-label":r.trendAria,children:[e.jsxs("header",{className:"surge-header",children:[e.jsx("h2",{children:r.trendTitle}),e.jsx("p",{children:r.trendNote})]}),e.jsx("ul",{className:"surge-list",children:Oe.length?Oe.map(o=>e.jsxs("li",{className:`surge-item trend-${o.direction}`,children:[e.jsxs("div",{children:[e.jsxs("span",{className:`pathogen-name ${ue(o.virus)}`,children:[e.jsx("span",{className:"virus-dot","aria-hidden":"true"}),e.jsx("strong",{children:J(o.virus,s)})]}),e.jsx("span",{children:o.week!=null?O(o.week,s):"–"})]}),e.jsx("span",{className:"pill",children:o.label})]},`${o.virus}-${o.week??"na"}`)):e.jsx("li",{className:"surge-empty",children:r.trendEmpty})})]}),e.jsxs("section",{className:"stats-grid briefing-stats-grid",children:[e.jsxs("article",{className:"stat-card",children:[e.jsxs("div",{className:"stat-card-ili-head",children:[e.jsx("h3",{children:r.statsTotalIli}),e.jsx("span",{className:"stat-week-chip",children:O(c.stats.latestWeek,s)})]}),e.jsx("strong",{children:c.stats.latestIliCases.toLocaleString()})]}),e.jsxs("article",{className:"stat-card",children:[e.jsxs("div",{className:"stat-card-ili-head",children:[e.jsx("h3",{children:r.statsLatestSari}),e.jsx("span",{className:"stat-week-chip",children:zi})]}),e.jsxs("strong",{children:[c.stats.latestSariAdmissions??"-"," / ",c.stats.latestSariIcu??"-"]})]}),e.jsxs("article",{className:"stat-card stat-card-ili-compare",children:[e.jsxs("div",{className:"stat-card-ili-head",children:[e.jsx("h3",{children:r.statsIliVsPrev}),e.jsx("span",{className:"stat-week-chip",children:Q?O(Q.week,s):"–"})]}),e.jsxs("div",{className:"stat-card-ili-main",children:[e.jsx("strong",{children:Q?Q.currentCases.toLocaleString():"–"}),(Q==null?void 0:Q.deltaPercent)!=null&&Q.previousCases!=null?e.jsx("span",{className:`stat-delta-pill trend-${Q.direction}`,children:ui(Q.deltaPercent)}):null]}),e.jsx("p",{className:"stat-compare-baseline",children:(Q==null?void 0:Q.deltaPercent)!=null&&Q.previousCases!=null?Z(r.statsIliVsPrevBaseline,{season:c.historical.compareSeasonLabel??String(c.selectedYear-1),value:Q.previousCases.toLocaleString()}):r.statsIliVsPrevNoBaseline})]}),e.jsxs("article",{className:"stat-card stat-card-age-split",children:[e.jsxs("div",{className:"stat-card-ili-head",children:[e.jsx("h3",{children:r.statsAgeSplit}),e.jsx("span",{className:"stat-week-chip",children:A.ageSplit?O(A.ageSplit.week,s):"–"})]}),A.ageSplit?e.jsxs("div",{className:"age-split-grid",children:[e.jsxs("span",{children:[r.rigorAge0to14,": ",A.ageSplit.age0to14.toFixed(1),"%"]}),e.jsxs("span",{children:[r.rigorAge15to34,": ",A.ageSplit.age15to34.toFixed(1),"%"]}),e.jsxs("span",{children:[r.rigorAge35to59,": ",A.ageSplit.age35to59.toFixed(1),"%"]}),e.jsxs("span",{children:[r.rigorAge60plus,": ",A.ageSplit.age60plus.toFixed(1),"%"]})]}):e.jsx("p",{className:"stat-compare-baseline",children:r.rigorAgeMissing})]})]})]}),e.jsxs("section",{id:"hu-ili-sari-charts",className:"charts-grid",children:[e.jsx(ce,{title:r.chartIli,subtitle:Z(r.chartIliSubtitle,{season:c.seasonLabel,threshold:c.iliThreshold.toLocaleString()}),option:zt}),e.jsx(ce,{title:r.chartSari,subtitle:Z(r.chartSariSubtitle,{season:c.seasonLabel}),option:At})]}),e.jsxs("section",{className:"historical-section",children:[e.jsxs("header",{className:"historical-header",children:[e.jsx("h2",{children:r.historicalTitle}),c.historical.available&&c.historical.compareSeasonLabel?e.jsx("p",{children:s==="hu"?`${c.historical.currentSeasonLabel} összevetve: ${c.historical.compareSeasonLabel}`:`${c.historical.currentSeasonLabel} vs ${c.historical.compareSeasonLabel}`}):e.jsx("p",{children:r.historicalEmptyHeader})]}),c.historical.available&&c.historical.compareSeasonLabel&&Li&&ji&&Ii?e.jsxs("div",{className:"historical-grid",children:[e.jsx(ce,{title:r.historicalIli,subtitle:Z(r.historicalDelta,{value:he(c.historical.ili.latestDeltaPercent)}),option:Li}),e.jsx(ce,{title:r.historicalSari,subtitle:Z(r.historicalDelta,{value:he(c.historical.sariAdmissions.latestDeltaPercent)}),option:ji}),e.jsx(ce,{title:r.historicalIcu,subtitle:Z(r.historicalDelta,{value:he(c.historical.sariIcu.latestDeltaPercent)}),option:Ii})]}):e.jsx("article",{className:"historical-empty",children:r.historicalUnavailable})]}),e.jsxs("section",{className:"virology-section collapsible-section",children:[e.jsxs("header",{className:"virology-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:r.virologyTitle}),e.jsx("p",{children:Z(r.virologyWeek,{week:Fe})})]}),e.jsxs("div",{className:"virology-header-actions",children:[e.jsxs("div",{className:"virology-controls",children:[e.jsx("label",{htmlFor:"virology-virus-select",children:r.virologyFilter}),e.jsxs("select",{id:"virology-virus-select",value:T,onChange:o=>f(o.target.value),children:[e.jsx("option",{value:ke,children:r.virologyAllViruses}),c.virology.availableDetectionViruses.map(o=>e.jsx("option",{value:o,children:J(o,s)},o))]})]}),e.jsxs("button",{type:"button",className:"section-toggle","aria-expanded":F,"aria-controls":"sentinel-virology-content","aria-label":`${F?r.sectionCollapse:r.sectionExpand}: ${r.virologyTitle}`,onClick:()=>D(o=>!o),children:[e.jsx("span",{className:`section-toggle-icon ${F?"open":""}`,"aria-hidden":"true",children:"▾"}),e.jsx("span",{children:F?r.sectionCollapse:r.sectionExpand})]})]})]}),F?e.jsxs("div",{id:"sentinel-virology-content",className:"section-content",children:[e.jsxs("div",{className:"virology-grid",children:[e.jsx(ce,{title:r.virologyDetectionsTrend,subtitle:Z(r.virologyDetectionsSubtitle,{week:Fe}),option:Tt}),e.jsx("div",{id:"hu-sentinel-positivity",children:e.jsx(ce,{title:r.virologyPositivityTrend,subtitle:Z(r.virologyDetectionsSubtitle,{week:Fe}),option:Ct})})]}),e.jsxs("div",{className:"virology-lists",children:[e.jsxs("article",{className:"virology-list-card compact",children:[e.jsx("h3",{children:r.virologyTopDetections}),Si.length?e.jsx("ul",{children:Si.map(o=>e.jsxs("li",{className:ue(o.virus),children:[e.jsxs("span",{className:"pathogen-name",children:[e.jsx("span",{className:"virus-dot","aria-hidden":"true"}),J(o.virus,s)]}),e.jsx("strong",{children:o.detections.toLocaleString()})]},`${o.virus}-${o.week}`))}):e.jsx("p",{className:"virology-empty",children:r.virologyNoDetections})]}),e.jsxs("article",{className:"virology-list-card compact",children:[e.jsx("h3",{children:r.virologyTopPositivity}),xi.length?e.jsx("ul",{children:xi.map(o=>e.jsxs("li",{className:ue(o.virus),children:[e.jsxs("span",{className:"pathogen-name",children:[e.jsx("span",{className:"virus-dot","aria-hidden":"true"}),J(o.virus,s)]}),e.jsxs("strong",{children:[o.positivity.toFixed(1),"%"]})]},`${o.virus}-${o.week}`))}):e.jsx("p",{className:"virology-empty",children:r.virologyNoPositivity})]})]})]}):null]}),e.jsxs("section",{className:"glance-section collapsible-section","aria-label":r.glanceAria,children:[e.jsxs("header",{className:"glance-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:r.glanceTitle}),e.jsx("p",{children:r.glanceNote})]}),e.jsxs("button",{type:"button",className:"section-toggle","aria-expanded":V,"aria-controls":"season-glance-content","aria-label":`${V?r.sectionCollapse:r.sectionExpand}: ${r.glanceTitle}`,onClick:()=>B(o=>!o),children:[e.jsx("span",{className:`section-toggle-icon ${V?"open":""}`,"aria-hidden":"true",children:"▾"}),e.jsx("span",{children:V?r.sectionCollapse:r.sectionExpand})]})]}),V?e.jsxs("div",{id:"season-glance-content",className:"glance-grid",children:[e.jsxs("article",{className:"glance-card",children:[e.jsx("h3",{children:r.glanceIli}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glancePeak}),e.jsx("span",{className:"glance-value",children:oi(((Fi=H.iliGlance)==null?void 0:Fi.peak)??null,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceLatest}),e.jsx("span",{className:"glance-value",children:li(H.iliGlance,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceSlope}),e.jsx("span",{className:"glance-value",children:ci(((Ri=H.iliGlance)==null?void 0:Ri.slope)??null,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceWow}),e.jsx("span",{className:"glance-value",children:he(H.iliWow)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceWeeksAbove}),e.jsx("span",{className:"glance-value",children:c.iliSeries.length?H.weeksAboveThreshold.toLocaleString():"–"})]})]}),e.jsxs("article",{className:"glance-card",children:[e.jsx("h3",{children:r.glanceSari}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glancePeak}),e.jsx("span",{className:"glance-value",children:oi(((Di=H.sariGlance)==null?void 0:Di.peak)??null,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceLatest}),e.jsx("span",{className:"glance-value",children:li(H.sariGlance,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceSlope}),e.jsx("span",{className:"glance-value",children:ci(((Vi=H.sariGlance)==null?void 0:Vi.slope)??null,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceWow}),e.jsx("span",{className:"glance-value",children:he(H.sariWow)})]})]}),e.jsxs("article",{className:"glance-card",children:[e.jsx("h3",{children:r.glanceIcu}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glancePeak}),e.jsx("span",{className:"glance-value",children:oi(((Mi=H.icuGlance)==null?void 0:Mi.peak)??null,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceLatest}),e.jsx("span",{className:"glance-value",children:li(H.icuGlance,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceSlope}),e.jsx("span",{className:"glance-value",children:ci(((Pi=H.icuGlance)==null?void 0:Pi.slope)??null,s)})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceWow}),e.jsx("span",{className:"glance-value",children:he(H.icuWow)})]})]}),e.jsxs("article",{className:"glance-card",children:[e.jsx("h3",{children:r.glanceStdTitle}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceStdIli}),e.jsx("span",{className:"glance-value",children:dt(H.iliSeasonToDate,{noBaseline:r.stdNoBaseline,median:r.stdMedian,lastSeason:r.stdLastSeason})})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceStdSari}),e.jsx("span",{className:"glance-value",children:dt(H.sariSeasonToDate,{noBaseline:r.stdNoBaseline,median:r.stdMedian,lastSeason:r.stdLastSeason})})]})]}),e.jsxs("article",{className:"glance-card",children:[e.jsx("h3",{children:r.glanceSeverityTitle}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceSeveritySari}),e.jsx("span",{className:"glance-value",children:H.severity?`${O(H.severity.week,s)}: ${H.severity.sariPercent.toFixed(1)}%`:"–"})]}),e.jsxs("div",{className:"glance-row",children:[e.jsx("span",{className:"glance-key",children:r.glanceSeverityIcu}),e.jsx("span",{className:"glance-value",children:H.severity&&Number.isFinite(H.severity.icuShare)?`${O(H.severity.week,s)}: ${Number(H.severity.icuShare).toFixed(1)}%`:"–"})]})]})]}):null]}),e.jsxs("section",{className:"quality-section","aria-label":r.rigorAria,children:[e.jsxs("header",{className:"quality-header",children:[e.jsx("h2",{children:r.rigorTitle}),e.jsx("p",{children:r.rigorNote})]}),e.jsxs("div",{className:"quality-grid",children:[e.jsxs("article",{className:`quality-card ${pe(A.iliMetric.baseline.zScore!=null&&Math.abs(A.iliMetric.baseline.zScore)>=2?"moderate":"good")}`,children:[e.jsx("h3",{children:r.rigorIliRateCard}),e.jsx("strong",{children:di(A.iliMetric.ratePer100k,r.rigorPer100kSuffix)}),e.jsxs("p",{children:[r.rigorWoW,": ",he(A.iliMetric.weekOverWeekPercent)," · ",r.rigorZScore,":"," ",mt(A.iliMetric.baseline.zScore)]}),e.jsxs("p",{children:[r.rigorBaselineSample,": ",is,A.iliMetric.baseline.baselineMean!=null?` · ${r.rigorBaselineMean}: ${di(It(A.iliMetric.baseline.baselineMean),r.rigorPer100kSuffix)}`:""]})]}),e.jsxs("article",{className:`quality-card ${pe(A.sariMetric.baseline.zScore!=null&&Math.abs(A.sariMetric.baseline.zScore)>=2?"moderate":"good")}`,children:[e.jsx("h3",{children:r.rigorSariRateCard}),e.jsx("strong",{children:di(A.sariMetric.ratePer100k,r.rigorPer100kSuffix)}),e.jsxs("p",{children:[r.rigorWoW,": ",he(A.sariMetric.weekOverWeekPercent)," · ",r.rigorZScore,":"," ",mt(A.sariMetric.baseline.zScore)]}),e.jsxs("p",{children:[r.rigorBaselineSample,": ",A.sariMetric.baseline.baselineCount.toLocaleString()]})]}),e.jsxs("article",{className:`quality-card ${pe(A.quality.ageLevel)}`,children:[e.jsx("h3",{children:r.rigorAgeSplitTitle}),A.ageSplit?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:O(A.ageSplit.week,s)}),e.jsxs("div",{className:"age-split-grid",children:[e.jsxs("span",{children:[r.rigorAge0to14,": ",A.ageSplit.age0to14.toFixed(1),"%"]}),e.jsxs("span",{children:[r.rigorAge15to34,": ",A.ageSplit.age15to34.toFixed(1),"%"]}),e.jsxs("span",{children:[r.rigorAge35to59,": ",A.ageSplit.age35to59.toFixed(1),"%"]}),e.jsxs("span",{children:[r.rigorAge60plus,": ",A.ageSplit.age60plus.toFixed(1),"%"]})]})]}):e.jsx("p",{children:r.rigorAgeMissing})]}),e.jsxs("article",{className:`quality-card ${pe(A.quality.coverageLevel)}`,children:[e.jsx("h3",{children:r.rigorQualityTitle}),e.jsxs("div",{className:"rigor-quality-list",children:[e.jsxs("span",{className:`rigor-pill ${pe(A.quality.coverageLevel)}`,children:[r.rigorQualityCoverage,": ",Xe(A.quality.coverageLevel)," (",es,")"]}),e.jsxs("span",{className:`rigor-pill ${pe(A.quality.baselineLevel)}`,children:[r.rigorQualityBaseline,": ",Xe(A.quality.baselineLevel)," (n=",A.quality.baselineCount,")"]}),e.jsxs("span",{className:`rigor-pill ${pe(A.quality.ageLevel)}`,children:[r.rigorQualityAge,": ",Xe(A.quality.ageLevel)]})]})]})]})]}),e.jsxs("section",{className:"table-section collapsible-section","aria-label":r.tableAria,children:[e.jsxs("header",{className:"table-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:r.tableTitle}),e.jsx("p",{children:r.tableNote})]}),e.jsxs("button",{type:"button",className:"section-toggle","aria-expanded":q,"aria-controls":"weekly-table-content","aria-label":`${q?r.sectionCollapse:r.sectionExpand}: ${r.tableTitle}`,onClick:()=>ae(o=>!o),children:[e.jsx("span",{className:`section-toggle-icon ${q?"open":""}`,"aria-hidden":"true",children:"▾"}),e.jsx("span",{children:q?r.sectionCollapse:r.sectionExpand})]})]}),q?e.jsx("div",{id:"weekly-table-content",className:"table-scroll",role:"region","aria-label":r.tableScrollAria,children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{scope:"col",className:"sortable",tabIndex:0,"aria-sort":Ft,onClick:()=>Ee("week"),onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),Ee("week"))},children:[e.jsx("span",{children:r.tableWeek}),e.jsx("span",{className:"sort-indicator","aria-hidden":"true",children:Dt})]}),e.jsx("th",{scope:"col",children:r.tableVirus}),e.jsx("th",{scope:"col",children:r.tableRegion}),e.jsxs("th",{scope:"col",className:"sortable",tabIndex:0,"aria-sort":Rt,onClick:()=>Ee("cases"),onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),Ee("cases"))},children:[e.jsx("span",{children:r.tableCases}),e.jsx("span",{className:"sort-indicator","aria-hidden":"true",children:Vt})]}),e.jsx("th",{scope:"col",children:r.tableSariAdmissions}),e.jsx("th",{scope:"col",children:r.tableSariIcu}),e.jsx("th",{scope:"col",children:r.tableTopPositivity})]})}),e.jsx("tbody",{children:Ai.length?Ai.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:O(o.week,s)}),e.jsx("td",{children:J(o.virus,s)}),e.jsx("td",{children:o.region==="National"?r.regionNational:o.region}),e.jsx("td",{children:Number.isFinite(o.cases)?Number(o.cases).toLocaleString():"–"}),e.jsx("td",{children:Number.isFinite(o.sariAdmissions)?Number(o.sariAdmissions).toLocaleString():"–"}),e.jsx("td",{children:Number.isFinite(o.sariIcu)?Number(o.sariIcu).toLocaleString():"–"}),e.jsx("td",{children:o.topPositivityVirus&&Number.isFinite(o.topPositivity)?e.jsxs("span",{className:`table-top-positivity ${ue(o.topPositivityVirus)}`,children:[e.jsx("span",{className:"virus-dot","aria-hidden":"true"}),e.jsxs("span",{children:[J(o.topPositivityVirus,s)," (",Number(o.topPositivity).toFixed(1),"%)"]})]}):"–"})]},o.week)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:r.tableNoData})})})]})}):null]})]}):null]}),e.jsxs("section",{className:"region-block eu-block","aria-label":r.sectionEuTitle,children:[e.jsxs("section",{className:"region-divider eu","aria-label":r.sectionEuTitle,children:[e.jsxs("div",{className:"region-divider-main",children:[e.jsx("span",{className:"region-divider-kicker",children:r.sectionKicker}),e.jsxs("div",{children:[e.jsx("h2",{children:r.sectionEuTitle}),e.jsx("p",{children:r.sectionEuNote})]})]}),e.jsxs("button",{type:"button",className:"section-toggle region-toggle","aria-expanded":Le,"aria-controls":"eu-region-content","aria-label":`${Le?r.sectionCollapse:r.sectionExpand}: ${r.sectionEuTitle}`,onClick:()=>ki(o=>!o),children:[e.jsx("span",{className:`section-toggle-icon ${Le?"open":""}`,"aria-hidden":"true",children:"▾"}),e.jsx("span",{children:Le?r.sectionCollapse:r.sectionExpand})]})]}),Le?e.jsx("div",{id:"eu-region-content",className:"region-content",children:e.jsxs("section",{className:"virology-section eu-section",children:[e.jsx("header",{className:"virology-header",children:e.jsxs("div",{children:[e.jsx("h2",{children:r.euVirologyTitle}),e.jsx("p",{children:Z(r.virologyWeek,{week:Je})})]})}),e.jsxs("div",{className:"virology-grid",children:[e.jsx(ce,{title:r.euDetectionsTrend,subtitle:Z(r.euTrendSubtitle,{season:Wi}),option:$t}),e.jsx("div",{id:"eu-positivity-chart",children:e.jsx(ce,{title:r.euPositivityTrend,subtitle:Z(r.euTrendSubtitle,{season:Wi}),option:Et})})]}),e.jsxs("div",{className:"virology-lists eu-summary-lists",children:[e.jsxs("article",{className:"virology-list-card compact",children:[e.jsx("h3",{children:r.euTopDetections}),Ni.length?e.jsx("ul",{children:Ni.map(o=>e.jsxs("li",{className:ue(o.virus),children:[e.jsxs("span",{className:"pathogen-name",children:[e.jsx("span",{className:"virus-dot","aria-hidden":"true"}),J(o.virus,s)]}),e.jsx("strong",{children:o.detections.toLocaleString()})]},`${o.virus}-${o.week}`))}):e.jsx("p",{className:"virology-empty",children:r.euNoDetections})]}),e.jsxs("article",{className:"virology-list-card compact",children:[e.jsx("h3",{children:r.euTopPositivity}),wi.length?e.jsx("ul",{children:wi.map(o=>e.jsxs("li",{className:ue(o.virus),children:[e.jsxs("span",{className:"pathogen-name",children:[e.jsx("span",{className:"virus-dot","aria-hidden":"true"}),J(o.virus,s)]}),e.jsxs("strong",{children:[o.positivity.toFixed(1),"%"]})]},`${o.virus}-${o.week}`))}):e.jsx("p",{className:"virology-empty",children:r.euNoPositivity})]})]})]})}):null]}),e.jsx("footer",{className:"dashboard-footer","aria-label":r.coverageAria,children:e.jsxs("div",{className:"footer-strip",role:"status","aria-live":"polite",children:[e.jsxs("span",{className:`footer-chip source ${Ot}`,children:[Gt,y?` (${r.sourceLoading})`:""]}),e.jsxs("span",{className:"footer-chip",children:[r.coverageNngyk,": ",Wt]}),e.jsxs("span",{className:"footer-chip",children:[r.coverageSari,": ",zi]}),e.jsxs("span",{className:"footer-chip",children:[r.coverageErviss,": ",Je]}),e.jsxs("span",{className:`footer-chip ${Ye.length+_e.length?"warn":"ok"}`,children:[r.coverageMissing,": ",Ye.length,"/",_e.length]}),e.jsx("span",{className:"footer-chip",children:ss}),e.jsx("span",{className:`footer-chip ${c.warnings.length?"warn":"ok"}`,title:rs,children:ns})]})})]})}as.createRoot(document.getElementById("root")).render(e.jsx(os.StrictMode,{children:e.jsx(yn,{})}));
